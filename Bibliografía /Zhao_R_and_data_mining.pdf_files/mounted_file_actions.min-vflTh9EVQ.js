define(["require","exports","tslib","react","react-redux","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/more_dropdown","modules/clean/react/file_viewer/open_button/open_button","modules/clean/react/title_bar/controls_container","modules/clean/react/user_notifications/dropdown","modules/clean/sharing/api/client","modules/clean/sharing/delete_link_modal","modules/clean/react/size_class/constants","modules/core/browser_detection","modules/clean/react/paper/utils","modules/clean/react/app_actions/app_actions_menu","modules/clean/react/file_viewer_sidebar/render_utils/call_to_action","modules/clean/react/file_viewer/share_button","modules/clean/react/size_class/utils","modules/clean/react/extensions/data/selectors"],(function(e,t,n,r,i,o,a,s,l,c,u,d,p,f,h,m,_,v,k,w,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=function(e,t){return{extensionsEnabled:C.extensionsEnabledForFile(e,t.file)}},M=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.cancelGetSharedLinkInfo=function(){},t.handleShareMenuItemClick=function(){k.handleShareClick(t.props.file,t.props.user)},t.removeShareLink=function(){var e=new d.ShareApiClient({userId:t.props.user.id}),n=t.state.linkMetadata,r=n.name,i=n.url;p.deleteLinkWithConfirm({client:e,contentName:r,onCancel:null,onDeleteLink:function(){return t.setState({linkMetadata:void 0})},url:i})},t}return n.__extends(t,e),t.prototype.setupShare=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return e=!1,this.cancelGetSharedLinkInfo=function(){e=!0},[4,new d.ShareApiClient({userId:this.props.user.id}).sharedLinkInfo({fileIdOrPath:this.props.file.fq_path})];case 1:return t=n.sent(),r=t[0],e||this.setState({linkMetadata:r}),this.cancelGetSharedLinkInfo=function(){},[2]}}))}))},t.prototype.componentDidMount=function(){this.setupShare()},t.prototype.componentDidUpdate=function(e){e.file!==this.props.file&&(this.cancelGetSharedLinkInfo(),this.setState({linkMetadata:void 0}),this.setupShare())},t.prototype.componentWillUnmount=function(){this.cancelGetSharedLinkInfo()},t.prototype.render=function(){var e=this.props,t=e.file,n=e.sizeClass,i=e.user,o=e.direction,a=!!this.state.linkMetadata&&this.state.linkMetadata.link_permissions.can_revoke;return r.default.createElement(s.MoreDropdown,{allowRemoveLink:a,isPrivate:!0,file:t,onClickShareLink:this.handleShareMenuItemClick,onRemoveShareLink:this.removeShareLink,sizeClass:n,user:i,direction:o})},t})((r=n.__importDefault(r)).default.PureComponent);t.UnconnectedMountedFileMoreDropdown=M,t.MountedFileMoreDropdown=i.connect(S)(M);var I=(function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(i,e),i.getDerivedStateFromProps=function(e){return{openInPaperButtonVariant:m.getOpenInPaperButtonVariant({file:e.file,user:e.user})}},i.prototype.logUserActionInTitleBarFactory=function(e){return function(){return o.logUserAction(e,a.UserActionContext.TitleBarMain)}},i.prototype.render=function(){var e=this.props,n=e.file,i=e.extensionsEnabled,o=e.sizeClass,s=e.shouldDisplayActionButtons,d=e.user;if(!!w.isSmallerThanLarge(o)){var p=null;return s&&!h.is_mobile_or_tablet()&&o!==f.SizeClass.Small&&(p=i?r.default.createElement("div",{className:"control__button"},r.default.createElement(_.ExtensionsMenu,{user:d,file:n,showAsButtonIfDownloadOnly:!0,hasOpenInPaperSupport:this.state.openInPaperButtonVariant===m.OpenInPaperButtonVariant.Dropdown,telemetryContext:{surface:"previews"},showBigTooltip:!0,onPresentInZoom:function(){return k.handlePresentInZoom(n,d)}})):r.default.createElement(l.OpenButton,{file:n,location:a.FileViewerPane.TitleBar,user:d})),r.default.createElement(c.TitleBarControlsContainer,null,p,r.default.createElement(t.MountedFileMoreDropdown,{file:this.props.file,user:this.props.user,sizeClass:this.props.sizeClass}))}var C=v.renderMountedFileActions(n,d,o,s,i),S=d.is_guest_admin?"":r.default.createElement(u.UserNotificationsDropdown,{isPagelet:!1,onClick:this.logUserActionInTitleBarFactory(a.UserAction.ClickNotifications)});return r.default.createElement(c.TitleBarControlsContainer,null,C,r.default.createElement(t.MountedFileMoreDropdown,{file:this.props.file,user:this.props.user,sizeClass:this.props.sizeClass}),r.default.createElement("div",{className:"react-title-bar__divider"}),S)},i})(r.default.Component);t.UnconnectedMountedFileActions=I,t.MountedFileActions=i.connect(S)(I)}));
//# sourceMappingURL=mounted_file_actions.min.js-vflLDFfLL.map