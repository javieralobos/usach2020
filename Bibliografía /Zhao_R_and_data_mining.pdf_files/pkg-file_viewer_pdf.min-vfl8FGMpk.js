define("modules/clean/react/file_viewer/frame_interface",["require","exports","tslib","modules/clean/react/file_viewer/interface","modules/clean/react/previews/frame_messenger_host","file-viewer/libraries/frame_messenger"],(function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["annotation-end-drag","annotation-enter","annotation-hidden","annotation-leave","annotation-placed","annotation-start-drag","annotation-ui-click","annotation-ui-enter","annotation-ui-leave","annotation-ui-over","mouse-up","on-keydown","page-change","page-rendered","scale-change","scroll","doc-metadata-load"],s=(function(e){function t(r){var n=e.call(this,r)||this;return n.handleMessageFromFrame=function(e){n.eventEmitter.emit(e.action,e.parameters)},t.frameMessengerFactory?n.frameMessenger=t.frameMessengerFactory():n.frameMessenger=new o.PreviewFrameMessengerHost,n.frameMessenger.configureChildMessaging('iframe[name="preview-content"]',n.handleMessageFromFrame,i),n.frameMessenger.startListening(),n}return r.__extends(t,e),t.prototype.dispatchEvent=function(e,t){a.logFrameMessage&&a.logFrameMessage("frame_interface",{eventName:e,data:t}),this.frameMessenger.postMessageToChildren(e,t)},t.prototype.destroy=function(){this.frameMessenger.stopListening()},t.setFrameMessengerFactory=function(e){t.frameMessengerFactory=e},t})(n.FileViewerInterface);t.FileViewerFrameInterface=s})),define("modules/clean/react/file_viewer/interface",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this.eventEmitter=e}return e.prototype.destroy=function(){},e})();t.FileViewerInterface=r})),define("modules/clean/react/file_viewer/sidebar_helpers",["require","exports","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/utils"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSidebarEnabled=function(e,t,o){return!(n.isSmallerThanLarge(t)||o||e!==r.DocType.ppt&&e!==r.DocType.pdf)}})),define("modules/clean/react/previews/pdf_viewer/event_emitter",["require","exports","tslib","eventemitter3"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),t.eventEmitter=new n.default})),define("modules/clean/react/previews/pdf_viewer/font",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renderFont=function(e){var t=e.n.lastIndexOf(",");return{fontFamily:'"'+(t>-1?e.n.substr(0,t):e.n)+'", '+(1&e.f?"monospace":"serif"),isBold:(e.f&1<<18)>0,isItalic:(64&e.f)>0}}})),define("modules/clean/react/previews/pdf_viewer/frame_messenger",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FRAME_MESSAGES_FROM_PARENT=["open-file","page-up","page-down","set-current-page","file-feedback-ui-ready","update-annotations","focus-annotation","hover-annotation","enable-annotation-creation","disable-annotation-creation","enable-region-creation","disable-region-creation","zoom-in","zoom-out","print","remove-all-annotations","scroll-to-annotation","clear-annotation-selection","request-doc-metadata","place-default-annotation","hide-annotation"],t.WT_EVENT_PAGE_RENDERED="page-rendered"})),define("modules/clean/react/previews/pdf_viewer/frame_messenger_shims",["require","exports","tslib","eventemitter3","file-viewer/libraries/frame_messenger"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);t.makeChannel=function(){return{parentEmitter:new n.default,childEmitter:new n.default}};var a=(function(e){function t(t){var r=e.call(this,[])||this;return r.eventListener=function(e){r.shimValidActions.indexOf(e.action)>-1&&r.handler(e)},r.channel=t,r}return r.__extends(t,e),t.prototype.configureChildMessaging=function(e,t,r){this.handler=t,this.shimValidActions=r},t.prototype.startListening=function(){this.channel.childEmitter.on("message",this.eventListener)},t.prototype.stopListening=function(){this.channel.childEmitter.off("message",this.eventListener)},t.prototype.postMessageToChildren=function(e,t){void 0===t&&(t={}),this.channel.parentEmitter.emit("message",{action:e,parameters:t})},t})(o.FrameMessengerHost);t.FrameMessengerHostShim=a;var i=(function(e){function t(t){var r=e.call(this,[])||this;return r.eventListener=function(e){r.shimValidActions.indexOf(e.action)>-1&&r.handler(e)},r.channel=t,r}return r.__extends(t,e),t.prototype.configureParentMessaging=function(e,t,r){void 0===r&&(r=null),this.shimValidActions=t,this.handler=e},t.prototype.postMessageToParent=function(e,t){void 0===t&&(t={}),this.channel.childEmitter.emit("message",{action:e,parameters:t})},t.prototype.startListening=function(){this.channel.parentEmitter.on("message",this.eventListener)},t.prototype.stopListening=function(){this.channel.parentEmitter.off("message",this.eventListener)},t})(o.FrameMessengerClient);t.FrameMessengerClientShim=i})),define("modules/clean/react/previews/pdf_viewer/keyboard_bindings",["require","exports","tslib","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/keycode"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLeftRightKeyboardBindings=function(e,t){return[n.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.LEFT},callback:e}),n.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.RIGHT},callback:t})]},t.getUpDownKeyboardBindings=function(e,t){return[n.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.UP},callback:e}),n.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.DOWN},callback:t})]},t.getPageUpPageDownKeyboardBindings=function(e,t){return[n.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.PAGE_UP},callback:e}),n.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.PAGE_DOWN},callback:t})]},t.getSinglePageKeyboardBindings=function(e){var a=e.pageUp,i=e.pageDown,s=e.zoomIn,l=e.zoomOut,d=e.print,c=n.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!1,which:o.KeyCode.SPACE},callback:i});return r.__spreadArrays([c],t.getPageUpPageDownKeyboardBindings(a,i),t.getUpDownKeyboardBindings(a,i),t.getLeftRightKeyboardBindings(a,i),n.getEqualsKeyBindings(s),n.getMinusKeyBindings(l),n.getPrintKeyBindings(d))},t.getContinuousPageKeyboardBindings=function(e){var a=e.isFullScreen,i=e.keyUp,s=e.keyDown,l=e.pageUp,d=e.pageDown,c=e.zoomIn,u=e.zoomOut,p=e.print,g=a?t.getUpDownKeyboardBindings(l,d):t.getUpDownKeyboardBindings(i,s),m=n.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!0,which:o.KeyCode.UP},callback:l}),f=n.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!0,which:o.KeyCode.DOWN},callback:d}),h=n.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!1,which:o.KeyCode.SPACE},callback:d}),v=a?r.__spreadArrays(t.getLeftRightKeyboardBindings(l,d)):[];return r.__spreadArrays(g,[m,f,h],t.getPageUpPageDownKeyboardBindings(l,d),v,n.getEqualsKeyBindings(c),n.getMinusKeyBindings(u),n.getPrintKeyBindings(p))}})),define("modules/clean/react/previews/pdf_viewer/layers",["require","exports","tslib","react","file-viewer/preview_doc","modules/clean/react/comments2/components/annotations/loadable","modules/clean/referrer_cleansing_redirect","file-viewer/preview_doc","modules/clean/react/watermarking/watermarking_layer","modules/clean/react/workflows/markup/markup_layer"],(function(e,t,r,n,o,a,i,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),i=r.__importStar(i),t._cleanseLinks=function(e){return void 0===e&&(e=[]),e.map((function(e){return e.a&&s.isLinkUrl(e.a)&&!e.a.ur.startsWith("mailto:")?r.__assign(r.__assign({},e),{a:r.__assign(r.__assign({},e.a),{ur:i.get_redirect_uri(o.normalizeUrl(e.a.ur)).toString()})}):e}))},t.createGenerateLayersFn=function(e,t,i){return function(s){return function(c){var u=s.config.load_image_only,p=s.filePreviewUiData.zoomScaleFactor,g=void 0===p?0:p,m=c.data,f=m.dimension,h=m.pageIndex,v={width:f[0]*g,height:f[1]*g},w=[n.default.createElement("div",{className:"c-loader",key:"loader"})],b=h+1;w.push(n.default.createElement(o.ImgLayer,r.__assign({},s,c,{key:"imgLayer"})));var _=null,P=null;return u||t||i||(_=n.default.createElement(o.TextLayer,r.__assign({},s,c,{key:"textLayer"})),P=n.default.createElement(o.LinksLayer,r.__assign({},s,c,{key:"linksLayer"}))),e?w.push(n.default.createElement(a.AnnotationViewLayer,{key:"annotationViewLayer",page:b}),n.default.createElement(a.AnnotationConductorLayer,{key:"annotationConductorLayer",page:b,layerSize:v},n.default.createElement(a.AnnotationInstructionalTooltipPane,{layerSize:v},t&&n.default.createElement(l.WatermarkingLayer,{layerSize:v,pageDimensions:{width:f[0],height:f[1]}}),i&&n.default.createElement(d.MarkupLayer,{page:h,layerSize:v,pageDimensions:{width:f[0],height:f[1]}}),_,P))):(t?w.push(n.default.createElement(l.WatermarkingLayer,{layerSize:v,pageDimensions:{width:f[0],height:f[1]}})):i&&w.push(n.default.createElement(d.MarkupLayer,{page:h,layerSize:v,pageDimensions:{width:f[0],height:f[1]}})),w.push(_,P)),w}}}})),define("modules/clean/react/previews/pdf_viewer/transform",["require","exports","tslib","modules/clean/react/previews/pdf_viewer/font","file-viewer/preview_doc","modules/clean/referrer_cleansing_redirect","modules/core/exception"],(function(e,t,r,n,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),i=r.__importStar(i),t.transformPdfCoordinates=function(e,t,r){return r.map((function(e){return e.coordinates.map((function(e){return{x:e.x,y:t-e.y}}))}))},t.transformViewportCoordinates=function(e,t,r,n,o,a,i){return i.map((function(i){return{coordinates:i.map((function(e){return{x:(e.x-t)/a,y:o-(e.y-r)/a}})),page:e,page_size:{width:n,height:o}}}))},t.transformPdfgenText=function(e){return e&&e.pages?Object.keys(e.pages).reduce((function(t,s){return t[s]=(e.pages[s]||[]).map((function(e){var t=(function(e){try{var t=o.transformText(e);return r.__assign(r.__assign({},t),{str:t.str.map((function(e){if(e.type===o.TextNodeType.link)try{return r.__assign(r.__assign({},e),{href:a.get_redirect_uri(e.text).toString()})}catch(e){}return e}))})}catch(e){i.reportException({err:new Error("PDF Text transformation failed"),tags:["pdfPreviews"],severity:i.SEVERITY.NONCRITICAL})}return{dir:o.TextDir.ltr,str:[]}})(e.t);return{d:e.d,t:e.t,r:e.r,h:e.h,rawText:e.t,transformedText:t.str,dir:t.dir,font:n.renderFont(e.font)}})),t}),{}):{}}})),define("modules/clean/react/previews/pdf_viewer/utils",["require","exports"],(function(e,t){"use strict";var r,n;function o(e){if(r===e)return n;var t=[];return e.forEach((function(e){for(var r=e[0],n=e[1],o=e[2],a=0;a<o;a++)t.push([r,n])})),r=e,n=t,t}Object.defineProperty(t,"__esModule",{value:!0}),t.expandDimensions=o,t.mapPages=function(e,t){for(var r=o(e),n=[],a=0;a<r.length;a++){var i=r[a],s=i[0],l=i[1];n.push(t(a,s,l))}return n},t.prefetchImage=function(e){(new Image).src=e},t.scaleDimension=function(e,t){void 0===t&&(t={});var r=e[0],n=e[1],o=t.maxWidth,a=t.maxHeight;if(void 0!==o&&void 0!==a){var i=Math.min(o/r,a/n);return[i*r,i*n]}return void 0!==o?[o,o/r*n]:void 0!==a?[a/n*r,a]:e}})),define("modules/clean/react/previews/pdf_viewer/zoom",["require","exports","modules/clean/previews/util","modules/core/browser_detection"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a,i=[1,2,4],s=Math.max.apply(Math,i);(function(e){e[e.NONE=0]="NONE",e[e.FIT_TO_WIDTH=1]="FIT_TO_WIDTH",e[e.FIT_PAGE=2]="FIT_PAGE"})(o=t.FittingMode||(t.FittingMode={})),(function(e){e[e.CONTINUOUS=0]="CONTINUOUS",e[e.SINGLE_PAGE=1]="SINGLE_PAGE"})(a=t.ScrollMode||(t.ScrollMode={})),t.fullscreenFittingMode=function(){return o.FIT_PAGE},t.defaultScrollMode=function(e){return r.isPptExtension(e)&&!n.is_mobile_or_tablet()?a.SINGLE_PAGE:a.CONTINUOUS},t.computeClientScaleFactor=function(e,t,r,n){var a=1;if(e===o.FIT_PAGE){for(var i=0,l=0,d=0,c=t;d<c.length;d++){var u=c[d],p=u[0],g=u[1];l=Math.max(p,l),i=Math.max(g,i)}a=Math.min(r/i,n/l)}else e===o.FIT_TO_WIDTH&&(a=n/t[0][0]);return Math.min(a,s)},t.calculatedFetchedScaleFactor=function(e,t){if(t){var r=t.originalHeight;if((function(e,t){return 2048/Math.max(e,t)})(t.originalWidth,r)>e)return 0}for(var n=0,o=i;n<o.length;n++){var a=o[n];if(a>=e)return a}return s}})),define("modules/clean/react/previews/powerpoint/frame_messenger_provider",["require","exports","tslib","react","modules/clean/react/previews/pdf_viewer/frame_messenger_shims","modules/clean/react/file_viewer/frame_interface","modules/clean/react/previews/pdf_viewer/event_emitter"],(function(e,t,r,n,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(t){var r=e.call(this,t)||this;r.onMessage=function(e){i.eventEmitter.emit(e.action,e.parameters)};var n=r.props,s=n.invalidate,l=n.messages;return r.channel=o.makeChannel(),r.host=new o.FrameMessengerHostShim(r.channel),r.client=new o.FrameMessengerClientShim(r.channel),r.client.configureParentMessaging(r.onMessage,l),r.client.startListening(),a.FileViewerFrameInterface.setFrameMessengerFactory((function(){return new o.FrameMessengerHostShim(r.channel)})),"function"==typeof s&&s(),r}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){this.client.stopListening()},t.prototype.render=function(){return this.props.children(this.client,this.host)},t})((n=r.__importDefault(n)).default.Component);t.FrameMessengerProvider=s})),define("modules/clean/react/previews/powerpoint/with_frame_messenger",["require","exports","tslib","react","hoist-non-react-statics","modules/clean/react/helpers","modules/clean/react/previews/powerpoint/frame_messenger_provider"],(function(e,t,r,n,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),o=r.__importDefault(o),t.withFrameMessenger=function(e){return function(t){var s=(function(o){function s(){var e=null!==o&&o.apply(this,arguments)||this;return e.displayName="WithFrameMessenger("+a.getDisplayName(t),e}return r.__extends(s,o),s.prototype.render=function(){var o=this;return n.default.createElement(i.FrameMessengerProvider,{messages:e,invalidate:this.props.invalidateFrameMessenger},(function(e,a){return n.default.createElement(t,r.__assign({},o.props,{frameMessengerClient:e,frameMessengerHost:a}))}))},s})(n.default.PureComponent);return o.default(s,t)}}})),define("modules/clean/react/previews/preview_pdf",["require","exports","tslib","react","modules/core/i18n","external/lodash","external/lodash","react-redux","classnames","modules/clean/react/previews/constants","file-viewer/core","modules/clean/react/file_viewer/location_utils","modules/clean/react/file_viewer/constants","modules/clean/react/previews/pdf_viewer/event_emitter","modules/clean/react/size_class/constants","modules/clean/react/file_viewer/data/selectors","modules/clean/previews/data/selectors","modules/clean/previews/data/actions","modules/clean/react/previews/preview_toolbar","modules/clean/web_timing_logger","modules/clean/react/previews/pdf_viewer/transform","modules/clean/react/previews/loading_indicator","modules/clean/react/previews/pdf_viewer/utils","modules/clean/react/file_viewer/sidebar_helpers","modules/clean/react/file_viewer/full_screen_helpers","modules/clean/react/previews/pdf_viewer/zoom","spectrum/dimensions","modules/clean/react/comments2/data/actions","modules/clean/react/comments2/data/selectors","modules/clean/react/keyboard_binding/keyboard_binding_connector","modules/core/browser","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/previews/pdf_viewer/keyboard_bindings","modules/clean/react/previews/pdf_viewer/urls","modules/clean/react/previews/pdf_viewer/frame_messenger","modules/clean/react/previews/powerpoint/with_frame_messenger","file-viewer/preview_doc","file-viewer/strings","file-viewer/core","modules/clean/i18n/formatters","modules/clean/react/previews/pdf_viewer/layers","modules/core/browser_detection","modules/clean/react/file_viewer/data/actions","modules/clean/react/file_viewer/data/actions","modules/clean/react/previews/preview_toolbar_button","file-viewer/toolbar","modules/clean/react/file_viewer/logging","file-viewer/assets-metaserver","modules/clean/react/previews/print_helpers","modules/clean/previews/actions","modules/constants/page_load","modules/clean/loggers/workflows_logger","modules/clean/react/watermarking/selectors","modules/clean/react/watermarking/utils","file-viewer/polyfills"],(function(e,t,r,n,o,a,i,s,l,d,c,u,p,g,m,f,h,v,w,b,_,P,y,S,M,E,T,F,C,D,I,k,A,U,x,O,L,W,N,B,K,R,z,V,j,Z,G,H,q,Q,Y,J,X,$){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),a=r.__importStar(a),l=r.__importDefault(l),b=r.__importStar(b),I=r.__importStar(I),R=r.__importStar(R);var ee=F.Actions.setPendingNumberedAnnotationMayBeOffscreen,te=B.createFormatters(Y.USER_LOCALE,W.strings),re=N.resolveAsset.bind(null,H.assets),ne=["pdf"];function oe(){}function ae(e){var t=e.imageUrlTmpl,r=e.useCanned,n=e.docMetadata,o=void 0===n?{}:n,i=o.metadata,s=void 0===i?void 0:i,l=o.text,d=void 0===l?{}:l;if(!s||!d||!s.page_count)return[];var c=y.expandDimensions(s.dimensions),u=_.transformPdfgenText(d);return a.range(0,s.page_count).map((function(e){return{pageIndex:e,dimension:c[e],textboxes:u&&u[e]||[],links:d.links&&d.links[e]||[],thumbnailUrl:U.imageUrl(t,e,0,r),imgUrls:{"1x":U.imageUrl(t,e,0,r),"4x":U.imageUrl(t,e,400,r)}}}))}var ie=(function(e){function t(t){var n=e.call(this,t)||this;n.downloadSucceedLogged=!1,n.renderSucceededLogged=!1,n.renderer=null,n.submitPassword=function(e){n._refreshBlob(e)},n.dismissPassword=function(){n.props.onError&&n.props.onError(d.ErrorType.PasswordProtectedError)},n._refreshBlob=function(e){var t=n.props,r=t.refreshBlobAction,o=t.revisionId,a=n.props,i=a.imageUrlTmpl,s=a.textUrlTmpl,l=a.refreshUrl;"function"==typeof r&&r(o,l||"",{image_url_tmpl:i,text_url_tmpl:s,refresh_url:l},e)},n._onScrollToPage=function(e){n.props.updateCurrentPageIndex(e),n.props.setPendingNumberedAnnotationMayBeOffscreen();var t=50*Math.floor(e/50);n.fetchDataForPage(t),t+50-e<15&&n.fetchDataForPage(t+50)},n.onMetadataLoad=function(e){n.props.frameMessengerClient.postMessageToParent("doc-metadata-load",{metadata:e})},n.logRenderSuccess=function(){n.downloadSucceedLogged||(n.downloadSucceedLogged=!0,n.logFilePreviewEvent(p.EventType.FilePreviewDownloadSucceeded)),n.renderSucceededLogged||(n.renderSucceededLogged=!0,n.logFilePreviewEvent(p.EventType.FilePreviewRenderSucceeded),"function"==typeof n.props.setRenderStatusSuccess&&n.props.setRenderStatusSuccess(),n.props.frameMessengerClient.postMessageToParent(x.WT_EVENT_PAGE_RENDERED)),n.setState({pageRendered:!0})},n.logTTI=function(){b.mark_time_to_view(),b.mark_time_to_interactive(),n.props.filePreviewSession&&n.props.filePreviewSession.markPrimaryEvent()},n.logWatermarkEvent=function(e,t){void 0===t&&(t={});var o=n.props,a=o.isWatermarkingMode,i=o.user,s=o.watermarkState;a&&J.logWorkflowsEvent(e,$.getWatermarkMilestone(i),r.__assign({watermark_type:s.mode},t))},n.sendIdleMouse=i.debounce((function(){n.props.frameMessengerClient.postMessageToParent("idle-mouse")}),1500),n.onMouseMove=i.throttle((function(){n.props.frameMessengerClient.postMessageToParent("active-mouse"),n.sendIdleMouse()}),16),n.onToolbarShow=function(){n.setState({isToolbarVisible:!0})},n.onToolbarHide=function(){n.setState({isToolbarVisible:!1})},n.onError=function(e){n.setState({error:e})},n.onImageError=function(){n.setState({error:o.intl.formatMessage({defaultMessage:"Some pages failed to load"})})},n.onReload=function(){I.reload(!0)},n.onPageNavigation=function(e){n.handlePageChange(e),n._jumpToPage(e)},n.handlePageChange=function(e){var t=n.state.currentPageIndex,r=n.props.docMetadata;!r||!r.metadata||e<0||e>=r.metadata.page_count||(n.setState({currentPageIndex:e}),n._onScrollToPage(e),g.eventEmitter.emit("page-set-to",e,t))},n.logSidebarPageClicked=function(){n.logWatermarkEvent(J.WorkflowsEvent.WatermarkPagePreviewClicked)},n._jumpToPage=function(e){n.renderer&&n.renderer.jumpToPage(e)},n.pageDown=function(){n.renderer&&(n.renderer.pageDown(),n.logWatermarkEvent(J.WorkflowsEvent.WatermarkArrowClicked,{arrow_clicked_direction:"down"}))},n.pageUp=function(){n.renderer&&(n.renderer.pageUp(),n.logWatermarkEvent(J.WorkflowsEvent.WatermarkArrowClicked,{arrow_clicked_direction:"up"}))},n.scrollDown=function(){n.renderer&&n.renderer.scrollDown()},n.scrollUp=function(){n.renderer&&n.renderer.scrollUp()},n.zoomIn=function(){var e=Math.min(1.1*n.state.scaleFactor,10);n.setState({scaleFactor:e,fittingMode:E.FittingMode.NONE})},n.zoomOut=function(){var e=Math.max(n.state.scaleFactor/1.1,.1);n.setState({scaleFactor:e,fittingMode:E.FittingMode.NONE})},n.jumpToPageWithLogging=function(e){G.wrapToolbarActionWithLogging(n._jumpToPage,p.UserAction.PageChange)(e),n.logWatermarkEvent(J.WorkflowsEvent.WatermarkPageNumberClicked)},n.handlePageUpWithToolbarLogging=G.wrapToolbarActionWithLogging(n.pageUp,p.UserAction.PageUp),n.handlePageDownWithToolbarLogging=G.wrapToolbarActionWithLogging(n.pageDown,p.UserAction.PageDown),n.handleZoomInWithToolbarLogging=G.wrapToolbarActionWithLogging(n.zoomIn,p.UserAction.ZoomIn),n.handleZoomOutWithToolbarLogging=G.wrapToolbarActionWithLogging(n.zoomOut,p.UserAction.ZoomOut),n.isPrintable=function(){return q.canPrint(n.props.sharePermission)&&!!n.props.autoprintUrl},n.print=function(e){n.isPrintable()&&n.props.autoprintUrl&&(Q.docPrint(n.props.autoprintUrl),G.logUserAction(p.UserAction.Print,e))},n.onPageUp=G.wrapKeyboardActionWithLogging(k.withPreventDefault(n.pageUp),p.UserAction.PageUp),n.onPageDown=G.wrapKeyboardActionWithLogging(k.withPreventDefault(n.pageDown),p.UserAction.PageDown),n.onScrollUp=G.wrapKeyboardActionWithLogging(k.withPreventDefault(n.scrollUp),p.UserAction.ScrollUp),n.onScrollDown=G.wrapKeyboardActionWithLogging(k.withPreventDefault(n.scrollDown),p.UserAction.ScrollDown),n.onZoomIn=G.wrapKeyboardActionWithLogging(k.withPreventDefault(n.zoomIn),p.UserAction.ZoomIn),n.onZoomOut=G.wrapKeyboardActionWithLogging(k.withPreventDefault(n.zoomOut),p.UserAction.ZoomOut),n.onPrintKeyPressed=k.withPreventDefault((function(){return n.print(p.UserActionContext.Keyboard)})),n.docFullScreenKeyboardBindings=A.getContinuousPageKeyboardBindings({isFullScreen:!0,keyUp:n.onScrollUp,keyDown:n.onScrollDown,pageUp:n.onPageUp,pageDown:n.onPageDown,zoomIn:n.onZoomIn,zoomOut:n.onZoomOut,print:n.onPrintKeyPressed}),n.docSidebarFocusedKeyboardBindings=A.getContinuousPageKeyboardBindings({isFullScreen:!1,keyUp:n.pageUp,keyDown:n.onPageDown,pageUp:n.onPageUp,pageDown:n.onPageDown,zoomIn:n.onZoomIn,zoomOut:n.onZoomOut,print:n.onPrintKeyPressed}),n.docKeyboardBindings=A.getContinuousPageKeyboardBindings({isFullScreen:!1,keyUp:n.onScrollUp,keyDown:n.onScrollDown,pageUp:n.onPageUp,pageDown:n.onPageDown,zoomIn:n.onZoomIn,zoomOut:n.onZoomOut,print:n.onPrintKeyPressed}),n.getDocKeyboardBindings=function(e){return e?n.docFullScreenKeyboardBindings:n.renderer&&n.renderer.state&&n.renderer.state.isSidebarFocused?n.docSidebarFocusedKeyboardBindings:n.docKeyboardBindings},n.handlePageScroll=function(){n.props.setPendingNumberedAnnotationMayBeOffscreen()},n.renderLayers=function(){return K.createGenerateLayersFn(n.props.annotationAllowed,n.props.isWatermarkingMode,n.props.isMarkupMode)},n.onDismissError=function(){n.setState({error:void 0})},n.handleOnSidebarOpen=function(){(0,n.props.onSidebarOpen)(p.DocType.pdf,p.UserActionContext.Toolbar),n.logWatermarkEvent(J.WorkflowsEvent.WatermarkToolbarClicked,{sidebar_state:"enabled"})},n.handleOnSidebarClose=function(){(0,n.props.onSidebarClose)(p.DocType.pdf,p.UserActionContext.Toolbar),n.logWatermarkEvent(J.WorkflowsEvent.WatermarkToolbarClicked,{sidebar_state:"disabled"})};var a=t.isFullscreen?E.fullscreenFittingMode():E.FittingMode.FIT_TO_WIDTH,s={passwordRetryAttempt:0,showPasswordPrompt:!1,fittingMode:a,currentPageIndex:0,isSidebarFocused:!1,scaleFactor:1,pages:[],isToolbarVisible:!1,persistToolbar:!1};return n.logFilePreviewEvent(p.EventType.FilePreviewSupportConfirmed),n.logFilePreviewEvent(p.EventType.FilePreviewDownloadAttempted),t.docMetadata&&t.docMetadata.metadata&&Array.isArray(t.docMetadata.metadata.dimensions)&&t.docMetadata.metadata.dimensions.length&&(s.scaleFactor=t.height&&t.width?E.computeClientScaleFactor(a,t.docMetadata.metadata.dimensions,t.height,t.width-24-16):1,s.pages=ae(t)),n.state=s,n}return r.__extends(t,e),Object.defineProperty(t.prototype,"startPage",{get:function(){if(this.props.location){var e=u.getPageQuery(this.props.location);if(e)return e-1}return 0},enumerable:!0,configurable:!0}),t.prototype.adjustWidth=function(e){return e-24-16-(this.isSidebarOpen()?L.SIDEBAR_WIDTH:0)},t.prototype.componentDidMount=function(){var e=this;"function"==typeof this.props.fetchDocMetadata&&this.props.fetchDocMetadata(this.props.revisionId,this.props.textUrlTmpl),this.refreshIntervalId=window.setInterval((function(){e._refreshBlob()}),108e5),g.eventEmitter.on("error",this.onError);var t=this.props.docMetadata,r=(void 0===t?{}:t).metadata,n=void 0===r?void 0:r;n&&this.startPage&&this.startPage>=0&&this.startPage<n.page_count&&this._jumpToPage(this.startPage)},t.prototype.componentWillUnmount=function(){g.eventEmitter.off("error",this.onError),window.clearInterval(this.refreshIntervalId),u.updatePageQuery(null),this.props.updateCurrentPageIndex(0)},t.prototype.componentDidUpdate=function(e){var t=e.documentRectangleToMakeVisible,r=e.docMetadata,n=(void 0===r?{}:r).metadata,o=void 0===n?void 0:n,a=this.props,i=a.documentRectangleToMakeVisible,s=a.docMetadata,l=(void 0===s?{}:s).metadata,d=void 0===l?void 0:l,c=a.height,u=a.width;if(i&&t!==i){var p=i.page;if(p!==this.state.currentPageIndex)return void this._jumpToPage(p)}if(!o&&d&&this.startPage&&this.startPage>=0&&this.startPage<d.page_count&&this._jumpToPage(this.startPage),e.isFullscreen!==this.props.isFullscreen){var g=e.isFullscreen?E.FittingMode.FIT_TO_WIDTH:E.FittingMode.FIT_PAGE;this.setState({fittingMode:g})}var m=this.isSidebarOpen(),f=this.isSidebarOpen(e);this.state.fittingMode!==E.FittingMode.NONE&&(e.height!==this.props.height||e.width!==this.props.width||m!==f)&&d&&Array.isArray(d.dimensions)&&d.dimensions.length&&this.setState({scaleFactor:E.computeClientScaleFactor(this.state.fittingMode,d.dimensions,c,this.adjustWidth(u))}),this.props.isEditMode&&!e.isEditMode&&d&&this.setState({fittingMode:E.FittingMode.FIT_PAGE,scaleFactor:E.computeClientScaleFactor(E.FittingMode.FIT_PAGE,d.dimensions,c,this.adjustWidth(u))}),!this.props.isEditMode&&e.isEditMode&&d&&this.setState({fittingMode:E.FittingMode.FIT_TO_WIDTH,scaleFactor:E.computeClientScaleFactor(E.FittingMode.FIT_TO_WIDTH,d.dimensions,c,this.adjustWidth(u))})},t.prototype.componentWillReceiveProps=function(e){var t=e.docMetadata,r=e.revisionId,n=e.fileExtension,o=e.isVirtualPreview,a=e.onLoad,i=e.textUrlTmpl,s=e.fetchDocMetadata,l=this.props,d=l.isVirtualPreview,u=l.revisionId,g=l.docMetadata,m=l.textUrlTmpl,f=this.state.fittingMode;if(this.props.isFullscreen!==e.isFullscreen&&(f=e.isFullscreen?E.fullscreenFittingMode():E.FittingMode.FIT_TO_WIDTH,this.setState({fittingMode:f})),r!==u||i!==m||o!==d)this.logFilePreviewEvent(p.EventType.FilePreviewSupportConfirmed),this.logFilePreviewEvent(p.EventType.FilePreviewDownloadAttempted),this.setState({pageRendered:!1,passwordRetryAttempt:0,showPasswordPrompt:!1}),this.downloadSucceedLogged=!1,this.renderSucceededLogged=!1,"function"==typeof s&&s(r,i);else if(t&&t!==g){var h=t.error,v=t.metadata;!h||g&&h===g.error?v?(g&&v===g.metadata||(v.page_count?g&&g.metadata||this.handleMetadataLoad(t,a):this.handleError(c.RivieraStatus.Unknown)),this.setState({pages:ae(e)})):this.handleError(c.RivieraStatus.Unknown,n):this.handleError(h.statusCode,n)}},t.prototype.logFilePreviewEvent=function(e,t){void 0===t&&(t={}),this.props.filePreviewSession&&this.props.filePreviewSession.recordEvent(e,t)},t.prototype.handleError=function(e,t){var r=this.props.onError;e===c.RivieraStatus.PasswordProtected?t&&ne.includes(t)?this.setState({showPasswordPrompt:!0,passwordRetryAttempt:this.state.passwordRetryAttempt+1}):"function"==typeof r&&r(d.ErrorType.PasswordProtectedError,e):(this.logFilePreviewEvent(p.EventType.FilePreviewDownloadFailed,{rivieraStatusCode:e?e.toString():""}),"function"==typeof r&&r(d.ErrorType.LoadError,e))},t.prototype.handleMetadataLoad=function(e,t){e&&(this.onMetadataLoad(e.metadata),"function"==typeof t&&t(),this.setState({showPasswordPrompt:!1}))},t.prototype.fetchDataForPage=function(e){if(e%50!=0)throw new Error("invalid page lower bound "+e);var t=this.props,r=t.revisionId,n=t.textUrlTmpl,o=t.docMetadata,a=t.fetchDataForPageAction;if("function"==typeof a){if(o){var i=o.metadata,s=o.text;if(i&&i.page_count<=e)return;if(s&&s.pages&&s.pages[e])return}a(r,n,e,e+50)}},t.prototype.isSidebarOpen=function(e){void 0===e&&(e=this.props);var t=e.isSidebarOpen,r=e.sizeClass,n=e.isFullscreen;return!(!S.isSidebarEnabled(p.DocType.pdf,r,!!n)||!(t||{})[p.DocType.pdf])},t.prototype.renderCloseFullscreenButton=function(){return this.props.isFullscreen?n.default.createElement("div",{className:"close-x"},n.default.createElement("button",{onClick:function(){return M.exitFullScreen(p.UserActionContext.Browser)},className:"close-x-button","aria-label":o.intl.formatMessage({defaultMessage:"Close"})},"âœ•")):null},t.prototype.render=function(){var e=this,t=this.props,r=t.currentMode,o=t.docMetadata,a=t.height,i=t.isArchiveFile,s=t.isEditMode,d=t.isFullscreen,u=t.isSidebarOpen,g=t.isVirtualPreview,f=t.previewMetadata,h=t.revisionId,v=t.sharePermission,b=t.sizeClass,_=t.width,y=this.state,E=y.scaleFactor,T=y.pages,F=y.currentPageIndex,C=y.pageRendered,I=y.passwordRetryAttempt,k=y.showPasswordPrompt,A=y.isToolbarVisible,U=y.error,x=o&&o.metadata&&o.metadata.page_count||0,O=this.renderCloseFullscreenButton(),W={"viewer-container":!0,"sidebar-visible":this.isSidebarOpen()},N=C?null:n.default.createElement(P.LoadingIndicator,{className:"loading-indicator"});return n.default.createElement("div",{className:"preview-content preview-pdf preview-pdf-ssr",onMouseMove:this.onMouseMove,onTouchStart:this.onMouseMove,onTouchMove:this.onMouseMove},k?n.default.createElement(L.PasswordModal,{className:"file-viewer-modal-overlay",intl:te,onSubmit:this.submitPassword,onDismiss:this.dismissPassword,enteredWrongPassword:I>1,onComponentDidMount:this.logTTI}):null,n.default.createElement("div",{className:l.default(W)},N,!s&&n.default.createElement(D.KeyboardBindingConnector,{keyboardBindings:this.getDocKeyboardBindings(!!this.props.isFullscreen)}),O,n.default.createElement(L.PreviewPDF,{fileMetadata:{file_id:h+(g?"-virtual":""),file_name:""},fileInfo:{file_id:h+(g?"-virtual":""),ns_id:0,sj_id:0,bootstrap:{state:"ready"}},filePreviewUiData:{currentPageIndex:F,zoomScaleFactor:E,fitScaleFactor:0,isSidebarOpen:!1},coreFileViewerUiData:{isDocSidebarOpen:this.isSidebarOpen()},fileViewerId:"",previewMetadata:f,className:l.default("pdf-viewer",{fullscreen:this.props.isFullscreen}),intl:te,height:a,isEditMode:s,currentMode:r,logSidebarPageClicked:this.logSidebarPageClicked,onPageChange:this.handlePageChange,onPageNavigation:this.onPageNavigation,onInteractive:this.logTTI,onPageImageError:this.onImageError,onRenderFailed:oe,onRenderSucceeded:this.logRenderSuccess,onScroll:this.handlePageScroll,pageClassName:"page",data:T,config:c.DEFAULT_CONFIG,pagesClassName:l.default("viewer-container__sizer","page-container","pdf-viewer__pages",{"ios-enable-inertial-scroll":R.iOS}),ref:function(t){return e.renderer=t},width:_,dispatch:oe,layerRenderFn:this.renderLayers(),resolveAsset:re}),U?n.default.createElement(L.ErrorSnackbar,{intl:te,className:A?"pdf-snackbar__toolbar-visible":"",error:U,onSubmit:this.onReload,onCancel:this.onDismissError}):null),o&&o.metadata&&o.metadata.page_count>0?n.default.createElement(w.PreviewToolbar,{isFullscreen:!!d,onToolbarShow:this.onToolbarShow,onToolbarHide:this.onToolbarHide,stayVisible:this.state.persistToolbar},S.isSidebarEnabled(p.DocType.pdf,b,!!d)?n.default.createElement(Z.SidebarToggleButton,{className:"toolbar-button-entry",intl:te,isSidebarOpen:u&&!!u[p.DocType.pdf],onSidebarOpen:this.handleOnSidebarOpen,onSidebarClose:this.handleOnSidebarClose}):null,b!==m.SizeClass.Small?n.default.createElement(Z.PageUpButton,{className:"toolbar-button-entry",disabled:F<=0,intl:te,onClick:this.handlePageUpWithToolbarLogging}):null,n.default.createElement(Z.PageIndicator,{className:"toolbar-button-entry",currentPageIndex:F||0,intl:te,id:"preview-toolbar-page-indicator",onBlur:function(){return e.setState({persistToolbar:!1})},onFocus:function(){return e.setState({persistToolbar:!0})},onPageNumberUpdated:this.jumpToPageWithLogging,pageCount:x||1,shouldShowPageCount:b!==m.SizeClass.Small}),b!==m.SizeClass.Small?n.default.createElement(Z.PageDownButton,{className:"toolbar-button-entry",disabled:F>=x-1,intl:te,onClick:this.handlePageDownWithToolbarLogging}):null,b===m.SizeClass.Small||s?null:[n.default.createElement(Z.ZoomOutButton,{className:"toolbar-button-entry",disabled:E<=.1,intl:te,onClick:this.handleZoomOutWithToolbarLogging}),n.default.createElement(Z.ZoomInButton,{className:"toolbar-button-entry",disabled:E>=10,intl:te,onClick:this.handleZoomInWithToolbarLogging}),n.default.createElement(Z.FullScreenButton,{className:"toolbar-button-entry",intl:te,onClick:function(){return M.toggleFullScreen(!!d,p.UserActionContext.Toolbar)}}),i?null:n.default.createElement(j.PreviewToolbarButton,{"data-test":"print",disabled:!this.isPrintable(),spriteGroup:"web",spriteName:"print",tooltip:q.getPrintTooltip(v),onClick:function(){return e.print(p.UserActionContext.Toolbar)}})]):null)},t})(n.default.PureComponent);t._PreviewPDF=ie;var se={refreshBlobAction:v.refreshBlobAction,fetchDocMetadata:v.fetchDocMetadata,fetchDataForPageAction:v.fetchDataForPage,updateCurrentPageIndex:z.updateCurrentPageIndex,setPendingNumberedAnnotationMayBeOffscreen:ee,onSidebarOpen:V.openSidebar,onSidebarClose:V.closeSidebar},le=i.flow([O.withFrameMessenger(x.FRAME_MESSAGES_FROM_PARENT),s.connect((function(e,t){return{docMetadata:h.getDocMetadataByRevisionId(e,t.revisionId),isSidebarOpen:f.getIsSidebarOpen(e),documentRectangleToMakeVisible:C.getDocumentRectangleToMakeVisibleIfComments2Ready(e),previewMetadata:h.getApiDataForRevisionId(e,t.revisionId),isVirtualPreview:h.getIsVirtualRevisionId(e,t.revisionId),annotationAllowed:f.getAnnotationAllowed(e),isWatermarkingMode:f.getIsWatermarkingMode(e),isMarkupMode:f.getIsMarkupMode(e),isEditMode:f.getIsEditMode(e),watermarkState:X.getWatermarkState(e)}}),se)])(ie);t.PreviewPDF=function(e){return n.default.createElement(T.Dimensions,{className:"flex-preview-container"},(function(t){var o=t.width,a=t.height;return n.default.createElement(le,r.__assign({},e,{width:o,height:a}))}))}})),define("modules/clean/react/previews/preview_ppt",["require","exports","tslib","react","classnames","modules/core/i18n","external/lodash","react-redux","file-viewer/core","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/constants","modules/clean/react/keyboard_binding/keyboard_binding_connector","modules/clean/react/previews/loading_indicator","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/file_viewer/data/selectors","modules/clean/react/previews/preview_toolbar","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/pdf_viewer/utils","modules/clean/react/previews/pdf_viewer/transform","modules/clean/react/previews/pdf_viewer/urls","modules/clean/react/previews/pdf_viewer/keyboard_bindings","file-viewer/preview_doc","modules/clean/react/previews/powerpoint/close_button","modules/clean/react/previews/pdf_viewer/event_emitter","modules/clean/react/file_viewer/full_screen_helpers","modules/clean/react/previews/powerpoint/with_frame_messenger","modules/clean/web_timing_logger","modules/clean/react/previews/powerpoint/with_document_metadata","modules/core/browser","modules/clean/react/previews/pdf_viewer/frame_messenger","file-viewer/strings","modules/clean/react/comments2/data/actions","modules/clean/react/comments2/data/selectors","modules/clean/react/previews/pdf_viewer/layers","file-viewer/core","spectrum/dimensions","modules/clean/react/file_viewer/data/actions","modules/clean/i18n/formatters","modules/clean/previews/data/selectors","modules/clean/react/file_viewer/sidebar_helpers","modules/clean/react/file_viewer/data/actions","modules/clean/react/previews/preview_toolbar_button","file-viewer/toolbar","modules/clean/react/file_viewer/logging","file-viewer/assets-metaserver","modules/clean/react/previews/print_helpers","modules/clean/previews/actions","modules/constants/page_load","file-viewer/polyfills"],(function(e,t,r,n,o,a,i,s,l,d,c,u,p,g,m,f,h,v,w,b,_,P,y,S,M,E,T,F,C,D,I,k,A,U,x,O,L,W,N,B,K,R,z,V,j,Z,G,H){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),o=r.__importDefault(o),T=r.__importStar(T),C=r.__importStar(C);var q=k.Actions.setPendingNumberedAnnotationMayBeOffscreen,Q=W.createFormatters(H.USER_LOCALE,I.strings),Y=l.resolveAsset.bind(null,j.assets);function J(){}var X=(function(e){function t(t){var r=e.call(this,t)||this;return r.downloadSucceedLogged=!1,r.renderSucceededLogged=!1,r.state={isSidebarFocused:!1,clientScaleFactor:0,showSidebar:!0,persistToolbar:!1},r.sendIdleMouse=i.debounce((function(){r.props.frameMessengerClient.postMessageToParent("idle-mouse")}),1500),r.onMouseMove=i.throttle((function(){r.props.frameMessengerClient.postMessageToParent("active-mouse"),r.sendIdleMouse()}),16),r.reload=function(){C.reload(!0)},r.dismissError=function(){r.setState({error:void 0})},r.setPage=function(e,t,n){var o=(void 0===n?r.props:n).docMetadata;o&&o.metadata&&(e<0||e>=o.metadata.page_count||(r.onPageChange(e),r.props.updateCurrentPageIndex(e)))},r.logRenderSuccess=function(){r.downloadSucceedLogged||(r.downloadSucceedLogged=!0,r.logFilePreviewEvent(d.EventType.FilePreviewDownloadSucceeded)),r.setState({pageRendered:!0}),r.renderSucceededLogged||(r.renderSucceededLogged=!0,r.logFilePreviewEvent(d.EventType.FilePreviewRenderSucceeded),"function"==typeof r.props.setRenderStatusSuccess&&r.props.setRenderStatusSuccess(),r.props.frameMessengerClient.postMessageToParent(D.WT_EVENT_PAGE_RENDERED))},r.onPageChange=function(e){var t=r.props,n=t.onPageChange,o=t.setPendingNumberedAnnotationMayBeOffscreen;n&&n(e),o()},r.logTTI=function(){T.mark_time_to_view(),T.mark_time_to_interactive();var e=r.props.filePreviewSession;e&&e.markPrimaryEvent()},r.pageDown=function(){var e=r.props;e.currentPageIndex<e.docMetadata.metadata.page_count-1&&r.props.pageDown()},r.pageUp=function(){r.props.currentPageIndex>0&&r.props.pageUp()},r.updateCurrentPageIndexWithToolbarLogging=V.wrapToolbarActionWithLogging((function(e){r.props.updateCurrentPageIndex(e)}),d.UserAction.PageChange),r.handlePageUpWithToolbarLogging=V.wrapToolbarActionWithLogging(r.pageUp,d.UserAction.PageUp),r.handlePageDownWithToolbarLogging=V.wrapToolbarActionWithLogging(r.pageDown,d.UserAction.PageDown),r.onError=function(e){r.setState({error:e})},r.onToolbarShow=function(){r.setState({isToolbarVisible:!0})},r.onToolbarHide=function(){r.setState({isToolbarVisible:!1})},r.setupToolbar=function(){S.eventEmitter.on("error",r.onError)},r.teardownToolbar=function(){S.eventEmitter.off("error",r.onError)},r.zoomIn=function(){if(!r.props.isFullscreen){var e=Math.min(1.1*r.state.clientScaleFactor,10);r.setState({clientScaleFactor:e})}},r.zoomOut=function(){if(!r.props.isFullscreen){var e=Math.max(r.state.clientScaleFactor/1.1,.1);r.setState({clientScaleFactor:e})}},r.handleZoomInWithToolbarLogging=V.wrapToolbarActionWithLogging(r.zoomIn,d.UserAction.ZoomIn),r.handleZoomOutWithToolbarLogging=V.wrapToolbarActionWithLogging(r.zoomOut,d.UserAction.ZoomOut),r.isPrintable=function(){return Z.canPrint(r.props.sharePermission)&&!!r.props.autoprintUrl},r.print=function(e){r.isPrintable()&&r.props.autoprintUrl&&(G.docPrint(r.props.autoprintUrl),V.logUserAction(d.UserAction.Print,e))},r.onPageUp=V.wrapKeyboardActionWithLogging(g.withPreventDefault(r.pageUp),d.UserAction.PageUp),r.onPageDown=V.wrapKeyboardActionWithLogging(g.withPreventDefault(r.pageDown),d.UserAction.PageDown),r.onZoomIn=V.wrapKeyboardActionWithLogging(g.withPreventDefault(r.zoomIn),d.UserAction.ZoomIn),r.onZoomOut=V.wrapKeyboardActionWithLogging(g.withPreventDefault(r.zoomOut),d.UserAction.ZoomOut),r.onPrintKeyPressed=g.withPreventDefault((function(){return r.print(d.UserActionContext.Keyboard)})),r.getPages=function(){var e=r.props,t=e.docMetadata,n=void 0===t?{}:t,o=n.metadata,a=void 0===o?void 0:o,s=n.text,l=void 0===s?{}:s,d=e.imageUrlTmpl,c=e.useCanned;if(!a||!l||!a.page_count)return[];var u=v.expandDimensions(a.dimensions),p=w.transformPdfgenText(l);return i.range(0,a.page_count).map((function(e){return{pageIndex:e,dimension:u[e]||[0,0],textboxes:p[e]||[],links:l.links&&l.links[e]||[],thumbnailUrl:b.imageUrl(d,e,0,c),imgUrls:{"1x":b.imageUrl(d,e,0,c),"4x":b.imageUrl(d,e,400,c)}}}))},r.renderLayers=function(){return U.createGenerateLayersFn(r.props.annotationAllowed,!1,!1)},r.logFilePreviewEvent(d.EventType.FilePreviewSupportConfirmed),t.docMetadata&&t.docMetadata.metadata&&r.logFilePreviewEvent(d.EventType.FilePreviewDownloadAttempted),r}return r.__extends(t,e),t.prototype.logFilePreviewEvent=function(e,t){void 0===t&&(t={});var r=this.props.filePreviewSession;r&&r.recordEvent(e,t)},t.prototype.componentDidMount=function(){this.logFilePreviewEvent(d.EventType.FilePreviewDownloadAttempted),this.setupToolbar();var e=this.props,t=e.docMetadata,r=e.startPage;t&&t.metadata&&r&&r>=0&&r<t.metadata.page_count&&this.setPage(r,l.UserActionContext.DocReset)},t.prototype.componentWillReceiveProps=function(e){var t=e.sizeClass,r=e.isFullscreen,n=e.isSidebarOpen,o=e.activatedAnnotationRectangle,a=e.docMetadata,i=B.isSidebarEnabled(d.DocType.ppt,t,!!r)&&!!(n||{})[d.DocType.ppt];if(this.setState({showSidebar:i}),o&&this.props.activatedAnnotationRectangle!==o&&this.setPage(o.page,l.UserActionContext.DocReset,e),a&&!a.error&&a.metadata){var s=a.metadata.dimensions;if(e.height!==this.props.height||e.width!==this.props.width||a!==this.props.docMetadata){var c=x.calculateFitBox(e.width-(n?P.SIDEBAR_WIDTH:0)-32,e.height,s[0][0]/s[0][1])[0];this.setState({clientScaleFactor:c/s[0][0]})}}},t.prototype.componentDidUpdate=function(e){e.currentPageIndex!==this.props.currentPageIndex&&this.onPageChange(this.props.currentPageIndex)},t.prototype.componentWillUnmount=function(){this.teardownToolbar(),h.updatePageQuery(null),this.props.updateCurrentPageIndex(0)},t.prototype.render=function(){var e=this,t=this.props,r=t.docMetadata,i=t.isArchiveFile,s=t.isFullscreen,g=t.isSidebarOpen,m=t.sharePermission,h=t.sizeClass,v=t.revisionId,w=t.width,b=t.height,S=t.currentMode,E=t.currentPageIndex,T=t.onSidebarClose,F=t.onSidebarOpen,C=t.previewMetadata,D=this.state,I=D.clientScaleFactor,k=D.showSidebar,A=D.error,U=D.isToolbarVisible,x=D.pageRendered;if(!r||!r.metadata)return null;var O=r.metadata,L=O&&O.page_count>0,W=_.getSinglePageKeyboardBindings({pageUp:this.onPageUp,pageDown:this.onPageDown,zoomIn:this.onZoomIn,zoomOut:this.onZoomOut,print:this.onPrintKeyPressed}),N=this.getPages(),K=null!=g&&!!g[d.DocType.ppt];return n.default.createElement("div",{className:"preview-content preview-pdf preview-pdf-ssr",onMouseMove:this.onMouseMove,onTouchStart:this.onMouseMove,onTouchMove:this.onMouseMove},n.default.createElement("div",{className:o.default({"viewer-container":!0,"sidebar-visible":k})},x?null:n.default.createElement(p.LoadingIndicator,{className:"loading-indicator"}),s?n.default.createElement(y.CloseButton,{onClick:function(){return M.exitFullScreen(d.UserActionContext.Browser)}}):null,n.default.createElement(u.KeyboardBindingConnector,{keyboardBindings:W}),n.default.createElement(P.PreviewPPT,{fileMetadata:{file_id:v,file_name:""},fileInfo:{file_id:v,ns_id:0,sj_id:0,bootstrap:{state:"ready"}},filePreviewUiData:{zoomScaleFactor:I,currentPageIndex:E,fitScaleFactor:0,isSidebarOpen:!1},coreFileViewerUiData:{isDocSidebarOpen:K},currentMode:S,previewMetadata:C,fileViewerId:"",className:"pdf-viewer",pageClassName:"page",data:N,intl:Q,onInteractive:this.logTTI,onRenderFailed:J,onRenderSucceeded:this.logRenderSuccess,onPageChange:this.setPage,width:w,height:b,dispatch:J,layerRenderFn:this.renderLayers(),config:l.DEFAULT_CONFIG,resolveAsset:Y}),L?n.default.createElement(f.PreviewToolbar,{isFullscreen:s,onToolbarShow:this.onToolbarShow,onToolbarHide:this.onToolbarHide,stayVisible:this.state.persistToolbar},B.isSidebarEnabled(d.DocType.ppt,h,!!s)?n.default.createElement(z.SidebarToggleButton,{className:"toolbar-button-entry",intl:Q,isSidebarOpen:K,onSidebarOpen:function(){return F(d.DocType.ppt,d.UserActionContext.Toolbar)},onSidebarClose:function(){return T(d.DocType.ppt,d.UserActionContext.Toolbar)}}):null,h!==c.SizeClass.Small?n.default.createElement(R.PreviewToolbarButton,{disabled:E<=0,spriteGroup:"web",spriteName:"up",tooltip:a.intl.formatMessage({defaultMessage:"Previous slide"}),onClick:this.handlePageUpWithToolbarLogging}):null,n.default.createElement(z.PageIndicator,{className:"toolbar-button-entry",currentPageIndex:E||0,intl:Q,id:"preview-toolbar-page-indicator",onBlur:function(){return e.setState({persistToolbar:!1})},onFocus:function(){return e.setState({persistToolbar:!0})},onPageNumberUpdated:this.updateCurrentPageIndexWithToolbarLogging,pageCount:N.length||1,shouldShowPageCount:h!==c.SizeClass.Small}),h!==c.SizeClass.Small?[n.default.createElement(R.PreviewToolbarButton,{disabled:E>=N.length-1,spriteGroup:"web",spriteName:"down",tooltip:a.intl.formatMessage({defaultMessage:"Next slide"}),onClick:this.handlePageDownWithToolbarLogging}),n.default.createElement(z.ZoomOutButton,{className:"toolbar-button-entry",disabled:I<=.1,intl:Q,onClick:this.handleZoomOutWithToolbarLogging}),n.default.createElement(z.ZoomInButton,{className:"toolbar-button-entry",disabled:I>=10,intl:Q,onClick:this.handleZoomInWithToolbarLogging}),n.default.createElement(z.FullScreenButton,{className:"toolbar-button-entry",intl:Q,onClick:function(){return M.toggleFullScreen(!!s,d.UserActionContext.Toolbar)}}),i?null:n.default.createElement(R.PreviewToolbarButton,{"data-test":"print",disabled:!this.isPrintable(),spriteGroup:"web",spriteName:"print",tooltip:Z.getPrintTooltip(m),onClick:function(){return e.print(d.UserActionContext.Toolbar)}})]:null):null,A?n.default.createElement(P.ErrorSnackbar,{intl:Q,className:U?"pdf-snackbar__toolbar-visible":"",error:A,onSubmit:this.reload,onCancel:this.dismissError}):null))},t})(n.default.PureComponent);t._PreviewPPT=X;var $={pageDown:L.pageDown,pageUp:L.pageUp,updateCurrentPageIndex:L.updateCurrentPageIndex,setPendingNumberedAnnotationMayBeOffscreen:q,onSidebarOpen:K.openSidebar,onSidebarClose:K.closeSidebar},ee=i.flow([F.withDocumentMetadata,E.withFrameMessenger(D.FRAME_MESSAGES_FROM_PARENT),s.connect((function(e,t){return{activatedAnnotationRectangle:A.getDocumentRectangleToMakeVisibleIfComments2Ready(e),currentPageIndex:m.getCurrentPageIndex(e)||0,isSidebarOpen:m.getIsSidebarOpen(e),previewMetadata:N.getApiDataForRevisionId(e,t.revisionId),annotationAllowed:m.getAnnotationAllowed(e)}}),$)])(X);t.PreviewPPT=function(e){return n.default.createElement(O.Dimensions,{className:"flex-preview-container"},(function(t){var o=t.width,a=t.height;return n.default.createElement(ee,r.__assign({},e,{width:o,height:a}))}))}}));
//# sourceMappingURL=pkg-file_viewer_pdf.min.js-vflUPZHmC.map