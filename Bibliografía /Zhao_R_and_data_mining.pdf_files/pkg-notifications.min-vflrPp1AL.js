define("modules/clean/edison/active_user_id",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveUserId=function(){var e=window;if(e.RUNNING_IN_EDISON)return e.EDISON_ACTIVE_USER_ID;if(e.ensemble){var t=e.ensemble.viewer.getActiveUser();if(t)return t.userId}}})),define("modules/clean/server_side_client_view_bridge",["require","exports","tslib"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultSuccess=0;t.ResultNoConnection=404;t.ResultInvalidRequest=-32600;t.ResultParseError=-32700;t.ResultNoTransport=-32999;var o=function(e){setTimeout((function(){throw new Error(e)}),0)};t.OverrideReportInitErrorForTest=function(e){o=e};var r=(function(){function e(){this.onEventFromDesktopClient=this.onEventFromDesktopClient.bind(this),this.resolvePromiseFromDesktopClient=this.resolvePromiseFromDesktopClient.bind(this),this.messageCounter=0,this.receiveListeners=[],this.callbackMap={},this.deferredInvokeQueue=[],this.hasEstablishedSession=!1,this.hasTransport=!1,this.desktopClientInfo=null,this.desktopClientExportsInfo=null,this.requestHandlers={onEventFromDesktopClient:this.onEventFromDesktopClient,resolvePromiseFromDesktopClient:this.resolvePromiseFromDesktopClient},this.eventHandlers={},this.View={},this.View.PromisedData={},this.sendMessage=function(){},this.close=function(){},"undefined"!=typeof _clientBridge&&null!==_clientBridge&&_clientBridge.enabled?(this.sendMessage=_clientBridge._SendMessageToDesktopClient,this.close=_clientBridge._Close,this.hasTransport=!0,_clientBridge._RegisterConnection(this)):o("During server side client view initialization, _clientBridge is undefined. This is not a new issue, but was previously not reported.")}return e.prototype.onOpen=function(){var e=this;this.hasEstablishedSession=!0,this._ensureDesktopClientInfo().then((function(){for(var t=0,n=Array.from(e.deferredInvokeQueue);t<n.length;t++){(0,n[t])()}return e.deferredInvokeQueue=[]}))},e.prototype.onClose=function(){this.close();for(var e=0,t=Object.keys(this.callbackMap||{});e<t.length;e++){var n=t[e];(0,this.callbackMap[n])({error:404})}this.callbackMap={}},e.prototype.onMessage=function(e){var t=JSON.parse(e);if("2.0"!==t.jsonrpc)throw Error("Invalid JSON RPC message. JSONRPC field is not 2.0");if(t.hasOwnProperty("method"))this.onRequest(t);else{if(!t.hasOwnProperty("error")&&!t.hasOwnProperty("result"))throw Error("Invalid JSON RPC message. None of {method, result, error} field present.");this.onResponse(t)}},e.prototype.onRequest=function(e){if(!e.hasOwnProperty("params"))throw Error("Invalid JSON RPC request: missing 'params' field.");if(!e.params.hasOwnProperty("name"))throw Error("Invalid JSON RPC request: missing 'params.name' field.");return this.requestHandlers[e.method].apply(void 0,n.__spreadArrays([e.params.name],Array.from(e.params.args)))},e.prototype.onResponse=function(e){if("number"!=typeof e.id)throw Error("Invalid JSON RPC message. Id field is not a number.");if("function"!=typeof this.callbackMap[e.id]&&void 0!==this.callbackMap[e.id])throw Error("Invalid JSON RPC response. Id is not recognized.");var t=this.callbackMap[e.id];delete this.callbackMap[e.id],void 0===t&&(t=function(){}),e.hasOwnProperty("error")?t({error:e.error,succeeded:!1}):e.hasOwnProperty("result")&&t({result:e.result,succeeded:!0})},e.prototype.subscribeEvent=function(e,t){var n=this;if(null==t||"function"!=typeof t)throw TypeError("Event subscription must have valid callback.");return i.invokeRemoteMethod("_validate_global_event_name",(function(o){if(o.succeeded)return n.eventHandlers.hasOwnProperty(e)||(n.eventHandlers[e]={}),n.eventHandlers[e][t]=t;throw Error("Invalid event name: "+e)}),[e])},e.prototype.unsubscribeEvent=function(e,t){if(this.eventHandlers.hasOwnProperty(e)&&this.eventHandlers[e].hasOwnProperty(t))return delete this.eventHandlers[e][t]},e.prototype.onEventFromDesktopClient=function(e){for(var t=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(this.eventHandlers.hasOwnProperty(e))return(function(){var o=[];for(var r in t.eventHandlers[e]){var i=t.eventHandlers[e][r];o.push(i.apply(void 0,Array.from(n||[])))}return o})()},e.prototype.getPromiseForPromisedDataFromDesktopClient=function(e){var t=this;this.View.PromisedData.hasOwnProperty(e)||(this.View.PromisedData[e]={}),this.View.PromisedData[e]._promise=new Promise((function(n,o){return t.View.PromisedData[e]._resolve=n,t.View.PromisedData[e]._reject=o}));return i.invokeRemoteMethod("_validate_promise_name",(function(n){if(n.succeeded)return t._tryResolvePromise(e);throw Error("Invalid promise name: "+e)}),[e]),this.View.PromisedData[e]._promise},e.prototype.resolvePromiseFromDesktopClient=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.View.PromisedData.hasOwnProperty(e)||(this.View.PromisedData[e]={}),this.View.PromisedData[e]._data=t,this._tryResolvePromise(e)},e.prototype._tryResolvePromise=function(e){var t;if(null!=this.View.PromisedData[e]._data&&null!=this.View.PromisedData[e]._resolve)return(t=this.View.PromisedData[e])._resolve.apply(t,Array.from(this.View.PromisedData[e]._data||[]))},e.prototype.formatFunctionId=function(e){return"com.dropbox.client.bridge-v1."+e},e.prototype.invokeRemoteMethod=function(e,t,n){if(this.hasTransport){if("function"!=typeof t&&void 0!==t)throw TypeError("Remote call must have valid completion callback, if specified.");if(this.hasEstablishedSession){var o={jsonrpc:"2.0",method:e=this.formatFunctionId(e),id:this.messageCounter};void 0!==n&&(o.params=n);var r=JSON.stringify(o),i=this.sendMessage(r);0===i?this.callbackMap[this.messageCounter++]=t:void 0!==t&&t({error:i})}else this.deferredInvokeQueue.push(this.invokeRemoteMethod.bind(self,e,t,n))}else void 0!==t&&t({error:-32999})},e.prototype.invokeRemoteMethodPromise=function(e,t){var n=this;return new Promise((function(o,r){return n.invokeRemoteMethod(e,(function(e){return null!=e.error?r(e.error):o(e.result)}),t)}))},e.prototype.isBridgeFunctionSupported=function(e){var t=this;return e=this.formatFunctionId(e),new Promise((function(n,o){return t._ensureDesktopClientInfo().then((function(){return null!=t.desktopClientInfo?n(t.desktopClientInfo.supportedFunctions.indexOf(e)>-1):o()}))}))},e.prototype._ensureDesktopClientInfo=function(){var e=this;return new Promise((function(t,n){return null!=e.desktopClientExportsInfo?t():e.invokeRemoteMethodPromise("_getDesktopClientInfo").then((function(n){return e.desktopClientInfo=n,e.desktopClientExportsInfo=!0,t()}),(function(n){return e.desktopClientExportsInfo=!1,t()}))}))},e})(),i=null;t.SubscribeEvent=function(e,t){return i.subscribeEvent(e,t)};t.UnsubscribeEvent=function(e,t){return i.unsubscribeEvent(e,t)};t.GetNamedPromise=function(e){return i.getPromiseForPromisedDataFromDesktopClient(e)};t.IsBridgeFunctionSupported=function(e){return i.isBridgeFunctionSupported(e)};t.init=function(){if(null===i)return i=new r};t.GetClientVersion=function(){var e,t,n=(e=null!=i?i.desktopClientInfo:void 0,t=function(e){return e.build_version},null!=e?t(e):void 0);if(!n)return null;var o=n.split("-");return(n=o.pop()).split(".").map((function(e){return parseInt(e)}))};t.GetPlatform=function(){if(i&&i.desktopClientInfo)return i.desktopClientInfo.platform};t.RefreshForInfinite=function(e){return i.invokeRemoteMethodPromise("refreshForInfinite",e)};t.ShouldDoKextOnboardingForPlatform=function(e,t){return i.invokeRemoteMethod("shouldDoKextOnboardingForPlatform",t,[e])};t.OpenUncredentialedBrowserWithAbsoluteURL=function(e,t){return i.invokeRemoteMethod("openUncredentialedBrowserWithAbsoluteURL",t,[e])};t.OpenUncredentialedBrowserWithDropboxURL=function(e,t){return i.invokeRemoteMethod("openUncredentialedBrowserWithDropboxURL",t,[e])};t.OpenUncredentialedBrowser=function(e,t){return i.invokeRemoteMethod("openUncredentialedBrowser",t,[e])};t.OpenCredentialedBrowser=function(e,t,n){return i.invokeRemoteMethod("openCredentialedBrowser",n,[e,t])};t.OpenPreferencesPane=function(e,t){return i.invokeRemoteMethod("openPreferencesPane",t,[e])};t.ListDirs=function(e,t,n){return i.invokeRemoteMethod("listDirs",n,[e,t])};t.GetSyncStatus=function(e,t,n){return i.invokeRemoteMethod("getSyncStatus",n,[e,t])};t.EvictSmartSyncFiles=function(e,t,n){return i.invokeRemoteMethod("evictSmartSyncFiles",n,[e,t])};t.RecallSmartSyncFiles=function(e,t,n){return i.invokeRemoteMethod("recallSmartSyncFiles",n,[e,t])};t.OpenContentIngest=function(e,t,n,o,r){return i.invokeRemoteMethod("openContentIngest",r,[e,t,n,o])};t.ContentIngestUpdateQuota=function(e,t){return i.invokeRemoteMethod("contentIngestUpdateQuota",t,[e])};t.HideTray=function(){return i.invokeRemoteMethod("hideTray")};t.CopyShmodelToClipboard=function(e,t,n,o){return i.invokeRemoteMethod("copyShmodelToClipboard",o,[e,t,n])};t.GetClipboardText=function(e){return i.invokeRemoteMethod("getClipboardText",e)};t.OpenDropboxFolderForRole=function(e,t){return i.invokeRemoteMethod("openDropboxFolderForRole",t,[e])};t.ReportEvent=function(e,t,n){return i.invokeRemoteMethod("reportEvent",n,[e,t])};t.SaveConfig=function(e,t,n){return i.invokeRemoteMethod("saveConfig",e,[t,n])};t.ForegroundServerView=function(e){return i.invokeRemoteMethod("foregroundServerView",e)};t.SetIsTopmostViewLevel=function(e,t){return i.invokeRemoteMethod("setIsTopmostViewLevel",t,[e])};t.CDOShowTrayOnboarding=function(e){return i.invokeRemoteMethod("CDO.ShowTrayOnboarding",e)};t.CDOHideTrayOnboarding=function(e){return i.invokeRemoteMethod("CDO.HideTrayOnboarding",e)};t.CDOSetOnboardingHeight=function(e,t){return i.invokeRemoteMethod("CDO.SetOnboardingHeight",t,[e])};t.CDOOpenDropboxFolder=function(e){return i.invokeRemoteMethod("CDO.OpenDropboxFolder",e)};t.CDOPinTrayPopup=function(e){return i.invokeRemoteMethod("CDO.PinTrayPopup",e)};t.CDOUnpinTrayPopup=function(e){return i.invokeRemoteMethod("CDO.UnpinTrayPopup",e)};t.CDOOpenUserFolder=function(e,t){return i.invokeRemoteMethod("CDO.OpenUserFolder",t,[e])};t.CDOStartEventMonitoring=function(e){return i.invokeRemoteMethod("CDO.StartEventMonitoring",e)};t.CDOStopEventMonitoring=function(e){return i.invokeRemoteMethod("CDO.StopEventMonitoring",e)};t.CDOGetAndClearEvents=function(e){return i.invokeRemoteMethod("CDO.GetAndClearEvents",e)};var a=function(e){return i.invokeRemoteMethod("CDO.ClearShowTrayConfig",e)};t.CDOClearShowTrayConfig=a,t.CDOClearShowTrayConfig=a=function(e){return i.invokeRemoteMethod("CDO.ClearShowTrayConfig",e)};t.KextShowAlertOrInstallAsync=function(){return i.invokeRemoteMethodPromise("InfiniteKextInstall.ShowAlertOrInstallAsync")};t.KextShowPrefsAndInstallAsync=function(){return i.invokeRemoteMethodPromise("InfiniteKextInstall.ShowPrefsAndInstallAsync")};t.KextShowPrefsAsync=function(){return i.invokeRemoteMethodPromise("InfiniteKextInstall.ShowPrefsAsync")};t.KextGetApprovalAsync=function(){return i.invokeRemoteMethodPromise("InfiniteKextInstall.GetApprovalAsync")};t.KextGetPrefsShownAsync=function(){return i.invokeRemoteMethodPromise("InfiniteKextInstall.GetPrefsShownAsync")};t.KextShowSelSyncAsync=function(){return i.invokeRemoteMethodPromise("InfiniteKextInstall.ShowSelSyncAsync")};t.SetupWizardReportEvent=function(e,t,n){null==t&&(t={}),i.invokeRemoteMethod("SetupWizard.SetupWizardReportEvent",n,[e,t])};t.SetupWizardOpenSelSyncPrefsASync=function(){return i.invokeRemoteMethodPromise("SetupWizard.OpenSelSyncPrefsASync")};t.SetupWizardOpenLocationPrefsAsync2=function(){return i.invokeRemoteMethodPromise("SetupWizard.OpenLocationPrefsAsync2")};t.SetupWizardLoginFinishedASync=function(e){return i.invokeRemoteMethodPromise("SetupWizard.LoginFinishedASync",[e])};t.SetupWizardFinished=function(e,t){return i.invokeRemoteMethod("SetupWizard.SetupFinished",t,[e])};t.SetupWizardPollForLink=function(e){return i.invokeRemoteMethod("SetupWizard.PollForLink",e)};t.SetupWizardFetchNewNonce=function(){return i.invokeRemoteMethodPromise("SetupWizard.FetchNewNonce")};t.SetupWizardGetAndResetShowInfiniteHardDowngradeMsg=function(e,t){return i.invokeRemoteMethod("SetupWizard.GetAndResetShowInfiniteHardDowngradeMsg",t,[e])};t.SetupWizardGetDropboxPath=function(e){return i.invokeRemoteMethod("SetupWizard.GetDropboxPath",e)};t.SetupWizardSetContentStartsOnlineOnly=function(e,t){return i.invokeRemoteMethod("SetupWizard.SetContentStartsOnlineOnly",t,[e])};t.SetupWizardGetClientInfoAndTag=function(e){return i.invokeRemoteMethod("SetupWizard.GetClientInfoAndTag",e)};t.TrayPopupContentReady=function(e){return i.invokeRemoteMethod("TrayPopupContent.Ready",e)};t.TrayPopupContentPong=function(e){return i.invokeRemoteMethod("TrayPopupContent.Pong",e)};t.TrayPopupContentUIStrings=function(e){return i.invokeRemoteMethod("TrayPopupContent.UIStrings",e)};t.TrayPopupContentReportRender=function(e,t){return i.invokeRemoteMethod("TrayPopupContent.ReportRender",t,[e])};t.TrayPopupContentReportRenderV2=function(e,t,n){return i.invokeRemoteMethod("TrayPopupContent.ReportRenderV2",n,[e,t])};t.TrayPopupContentReportRefreshed=function(e,t){return i.invokeRemoteMethod("TrayPopupContent.ReportRefreshed",t,[e])};t.TrayPopupContentRenderBadAssumption=function(e,t,n){return i.invokeRemoteMethod("TrayPopupContent.RenderBadAssumption",n,[e,t])};t.TrayPopupContentDismissPaperCallout=function(e){return i.invokeRemoteMethod("TrayPopupContent.DismissPaperCallout",e)};t.TrayPopupContentDownloadThumbnail=function(e,t){return i.invokeRemoteMethod("TrayPopupContent.DownloadThumbnail",t,[e])};t.TrayPopupContentPerformStickyAction=function(e,t,n){return i.invokeRemoteMethod("TrayPopupContent.PerformStickyAction",n,[e,t])};t.TrayPopupContentPerformNotificationAction=function(e,t,n,o){return i.invokeRemoteMethod("TrayPopupContent.PerformNotificationAction",o,[e,t,n])};t.TrayPopupContentPerformNotificationMarkAllRead=function(e,t){return i.invokeRemoteMethod("TrayPopupContent.PerformNotificationMarkAllRead",t,[e])};t.TrayPopupContentPerformNotificationMarkRead=function(e,t){return i.invokeRemoteMethod("TrayPopupContent.PerformNotificationMarkRead",t,[e])};t.TrayPopupContentPerformNotificationMarkSpam=function(e,t){return i.invokeRemoteMethod("TrayPopupContent.PerformNotificationMarkSpam",t,[e])};t.TrayPopupContentPerformFileAction=function(e,t,n){return i.invokeRemoteMethod("TrayPopupContent.PerformFileAction",n,[e,t])};t.TrayPopupContentPerformRecallAction=function(e,t,n){return i.invokeRemoteMethod("TrayPopupContent.PerformRecallAction",n,[e,t])};t.TrayPopupContentLinkClient=function(e){return i.invokeRemoteMethod("TrayPopupContent.LinkClient",e)};t.TrayPopupContentShowOtherAccountView=function(e,t){return i.invokeRemoteMethod("TrayPopupContent.ShowOtherAccountView",t,[e])};t.TrayPopupContentShowMoreNotifications=function(e,t){return i.invokeRemoteMethod("TrayPopupContent.ShowMoreNotifications",t,[e])};t.TrayPopupOpenSearch=function(e,t){return i.invokeRemoteMethod("SurfacePrototype.OpenSearchResults",t,[e])};t.TwoAccountPromoExitPromo=function(e,t){return i.invokeRemoteMethod("TwoAccountPromo.exit_promo",t,[e])};t.HomeOpenFileOrFolder=function(e,t,n){return i.invokeRemoteMethod("Home.openFileOrFolder",n,[e,t])};t.BugReporterGetReportDictionary=function(e){return i.invokeRemoteMethod("bugreporter.getReportDictionary",e)};t.TestDeferral=function(e,t,n){return i.invokeRemoteMethodPromise("DEBUG.testDeferral",[e,t,n])};t.PaywallDeviceLimitUnlinkOthersSuccess=function(e){return i.invokeRemoteMethod("PaywallDeviceLimit.unlinkOthersSuccess",e)};t.OpenUpgradePageForPaywallDeviceLimit=function(e){return i.invokeRemoteMethod("PaywallDeviceLimit.openUpgradePage",e)};t.Mountain=function(e){return i.invokeRemoteMethod("Mountain.mountain",e)};t.AcknowledgePromptOnTray=function(e,t){return i.invokeRemoteMethod("DesktopPrompt.acknowledgePromptOnTray",t,[e])};t.SetPromptCampaignOnTray=function(e,t){return i.invokeRemoteMethod("DesktopPrompt.setPromptCampaignOnTray",t,[e])};t.ViewManagementShow=function(){return i.invokeRemoteMethodPromise("view_management.show")};t.ViewManagementClose=function(){return i.invokeRemoteMethodPromise("view_management.close")};t.ViewManagementHide=function(){return i.invokeRemoteMethodPromise("view_management.hide")};t.ViewManagementSetPosition=function(e,t,n,o){return i.invokeRemoteMethodPromise("view_management.set_position",[e,t,n,o])};t.ViewManagementMove=function(e,t){return i.invokeRemoteMethodPromise("view_management.move",[e,t])};t.ViewManagementResize=function(e,t){return i.invokeRemoteMethodPromise("view_management.resize",[e,t])};t.ViewManagementGetTitle=function(){return i.invokeRemoteMethodPromise("view_management.get_title")};t.ViewManagementSetTitle=function(e){return i.invokeRemoteMethodPromise("view_management.set_title",[e])};t.ViewManagementGetCurrentDisplay=function(){return i.invokeRemoteMethodPromise("view_management.get_current_display")};t.ViewManagementGetMainDisplay=function(){return i.invokeRemoteMethodPromise("view_management.get_main_display")};t.ViewManagementGetAllDisplays=function(){return i.invokeRemoteMethodPromise("view_management.get_all_displays")};t.InviteMemberModalHandleInviteSuccess=function(e){return i.invokeRemoteMethodPromise("InviteMembersModal.HandleInviteSuccess",[e])}})),define("modules/clean/loggers/notification_tray_logger",["require","exports","tslib","modules/clean/ajax"],(function(e,t,n,o){"use strict";function r(e){o.SilentBackgroundRequest({url:"/log/notif_tray_events",data:{event_dict:JSON.stringify(e)}})}Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),t.logTrayOpen=function(e){r({event_name:"tray_popup_shown",badge_count:e})},t.logMarkAllAsRead=function(){r({event_name:"mark_all_as_read"})}})),define("modules/clean/photos/batch_thumb_loader",["require","exports","tslib","modules/clean/ajax","modules/clean/react/no-jquery","modules/constants/env","modules/core/uri"],(function(e,t,n,o,r,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),i=n.__importStar(i);var s=(function(){function e(e){var t=e.batch_size,n=e.max_parallel_requests,o=e.on_batch,r=e.batch_logger,i=e.on_batch_success;this.on_batch=o,this.batch_logger=r,this.on_batch_success=i,this.batch_size=t||16,this.max_parallel_requests=n||6,this.thumb_url_queue=[],this.batch_queue=[],this.callback_by_id={},this.request_ids_by_url={},this.num_requests_in_flight=0,this.flushing=!1,this.last_thumb_request_id=0,this.next_batch_id=0,this.cancelled_urls={},this.outstanding_batches={},this._request_callback_by_request_id={}}return e.prototype.vend_request_id=function(){return this.last_thumb_request_id++,this.last_thumb_request_id.toString()},e.prototype.queue_thumb=function(e,t,n){void 0===n&&(n={});var o=n.request_id,a=n.onrequest;if(r.corsSupport()&&i.BATCH_THUMB_ENDPOINTS.length){if(o||(o=this.vend_request_id()),this.request_ids_by_url[e]&&this.request_ids_by_url[e].length){var s=!1;for(var u in this.outstanding_batches)if(this.outstanding_batches[u]&&this.outstanding_batches[u].urls)for(var c=0,l=this.outstanding_batches[u].urls;c<l.length;c++){l[c]===e&&(s=!0)}s&&"function"==typeof a&&a()}else this.thumb_url_queue.push(e),this.request_ids_by_url[e]=[];return this.request_ids_by_url[e].push(o),t&&(this.callback_by_id[o]={url:e,callback:t}),this._request_callback_by_request_id[o]=a,this.thumb_url_queue.length>=this.batch_size&&(this.batch_queue.push(this.thumb_url_queue.splice(0,this.batch_size)),this._send_batch_requests()),o}"function"==typeof a&&a();return t&&"function"==typeof t&&t(e,!0),null},e.prototype.cancel_thumb=function(e){if(this.callback_by_id[e]){var t=this.callback_by_id[e].url;delete this.callback_by_id[e],delete this._request_callback_by_request_id[e];for(var n=0;n<this.request_ids_by_url[t].length;n++){if(this.request_ids_by_url[t][n]===e){this.request_ids_by_url[t].splice(n,1);break}}if(0===this.request_ids_by_url[t].length){delete this.request_ids_by_url[t];for(n=0;n<this.thumb_url_queue.length;n++)if(this.thumb_url_queue[n]===t)return void this.thumb_url_queue.splice(n,1);for(n=0;n<this.batch_queue.length;n++)for(var o=this.batch_queue[n],r=0;r<o.length;r++)if(o[r]===t)return o.splice(r,1),void(0===o.length&&this.batch_queue.splice(n,1));for(var i in this.cancelled_urls[t]=1,this.outstanding_batches)if(this.outstanding_batches[i]&&this.outstanding_batches[i].urls){for(var a=this.outstanding_batches[i],s=a.urls,u=a.request,c=!0,l=0,d=s;l<d.length;l++){var p=d[l];c=null!=this.cancelled_urls[p]&&c}if(c){u.abort();break}}}}},e.prototype.flush=function(){for(;this.thumb_url_queue.length;)this.batch_queue.push(this.thumb_url_queue.splice(0,this.batch_size));this._send_batch_requests()},e.prototype.reset=function(e){var t=e.batch_size,n=e.batch_logger;this.batch_logger=n,this.batch_size=t||16},e.prototype.clear=function(){this.thumb_url_queue=[]},e.prototype.pause=function(){this.flushing=!1},e.prototype._send_batch_requests=function(){if(!(0===this.batch_queue.length||this.num_requests_in_flight>=this.max_parallel_requests)&&this.batch_queue.length>0){this.flushing=!0;var e=this.batch_queue.shift(),t=this._generate_request_params(e),n=t.endpoint,r=t.method,i=t.data;this.on_batch&&"function"==typeof this.on_batch&&this.on_batch(e);for(var a=0,s=e;a<s.length;a++)for(var u=s[a],c=0,l=this.request_ids_by_url[u];c<l.length;c++){var d=l[c],p=this._request_callback_by_request_id[d];p&&"function"==typeof p&&p(),delete this._request_callback_by_request_id[d]}var f=this.next_batch_id;this.next_batch_id++,this.num_requests_in_flight++;var _=o.SilentBackgroundRequest({xhrFields:{withCredentials:!0},url:n,type:r,data:i,success:this._success.bind(this,e),error:this._error.bind(this,e),complete:this._complete.bind(this,f)});this.outstanding_batches[f]={urls:e,request:_},this._send_batch_requests()}},e.prototype._success=function(e,t){for(var n=t.split("\n"),o={},r=0,i=e;r<i.length;r++){var a=i[r];o[a]=!1}for(var s=0;s<n.length;s++){var u=n[s],c=u.indexOf(":");if(-1!==c){var l=u.substring(0,c).split("-"),d=parseInt(l[0],10),p=u.substring(c+1);a=e[d];o[a]=!0,this._call_callback(a,p),this.batch_logger&&"function"==typeof this.batch_logger&&this.batch_logger(s,e.length)}}this.on_batch_success&&"function"==typeof this.on_batch_success&&this.on_batch_success(e);for(var f=0,_=e.filter((function(e){return!o[e]}));f<_.length;f++){a=_[f];this.cancelled_urls[a]||this._call_callback(a,a)}},e.prototype._error=function(e){for(var t=0,n=e;t<n.length;t++){var o=n[t];this._call_callback(o,o)}},e.prototype._complete=function(e){this.num_requests_in_flight--;for(var t=0,n=this.outstanding_batches[e].urls;t<n.length;t++){var o=n[t];delete this.cancelled_urls[o]}delete this.outstanding_batches[e],this.flushing&&this._send_batch_requests()},e.prototype._call_callback=function(e,t){var n;if(n=0===t.indexOf("data:image")?t:e,this.request_ids_by_url[e])for(var o=0,r=this.request_ids_by_url[e].slice();o<r.length;o++){var i=r[o];this.callback_by_id[i]&&(this.callback_by_id[i].callback(n,!1),delete this.callback_by_id[i])}delete this.request_ids_by_url[e]},e.prototype._generate_request_params=function(e){var t=e.map((function(e){return a.URI.parse(e).setScheme().setAuthority().toString()})),n=JSON.stringify(t),o=Math.abs(this._hash_string_to_int(n))%i.BATCH_THUMB_ENDPOINTS.length,r=i.BATCH_THUMB_ENDPOINTS[o],s={image_urls:n};return{endpoint:r,method:a.URI.parse(r).setQuery(s).toString().length>6e3?"POST":"GET",data:s}},e.prototype._hash_string_to_int=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n)}return t},e})();t.BatchThumbLoader=s})),define("modules/clean/react/account_menu/account_menu",["require","exports","tslib","react","reselect","modules/clean/ajax_as_promised","modules/clean/event_handler","modules/clean/react/account_menu/account_menu_view","modules/clean/react/css","modules/core/uri","modules/clean/api_v2/user_client","modules/clean/react/account_menu/account_menu_types","modules/clean/react/account_menu/account_menu_util","modules/clean/web_timing_logger","modules/clean/analytics","modules/clean/snapengage"],(function(e,t,n,o,r,i,a,s,u,c,l,d,p,f,_,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o);var h=(function(t){function u(o){var i=t.call(this,o)||this;return i.getUpsellLinks=r.createSelector((function(e){return e.user}),(function(e){return e.viewer}),(function(e,t){var n,o=[];return e.is_team||e.paid?e.is_team||!e.paid||t.role_exists("work")?e.is_team&&t.team_is_limited&&(o=[p.upsellLinks.TRY_BUSINESS]):n=p.upsellLinks.TRY_BUSINESS:n=p.upsellLinks.UPGRADE_PLANS,{quotaBarCTA:n,menuItemUpsells:o}})),i.state={accountPhotoUrl:i.props.accountPhotoUrl||i.props.user.photo_circle_url,isDisabled:!0,accountSpaceUsage:{currentStatus:d.AccountSpaceUsageStatus.NOT_APPLICABLE},experimentExposuresLogged:!1,portkeyChatDiscoverability:"OFF"},i.handleChatLink=function(e){i.widgetId&&(m.DropboxSnapEngage.startSupportChat(i.widgetId),_.TeamsWebActionsLogger.log("chat_discoverability_account_menu_clicked"))},i.handleChangeAvatar=function(){new Promise((function(t,n){e(["modules/clean/account_photo_modal/controller"],t,n)})).then(n.__importStar).then((function(e){return(0,e.AccountPhotoModalController.show)()}))},i.mounted=!1,i}return n.__extends(u,t),u.prototype.componentDidMount=function(){var t=this;this.mounted=!0,this.getQuotaData(),this.events.on(document,"db:account_photo:photo_set",(function(e,n){var o=c.URI.parse(n.saved_photo_url).updateQuery({size:"64x64"}).toString();t.setState({accountPhotoUrl:o})})),this.events.on(document,"db:account_photo:photo_deleted",(function(){t.setState({accountPhotoUrl:null})})),this.setState({isDisabled:!1}),f.waitForTTI().then((function(){new Promise((function(t,n){e(["modules/clean/account/timezone_detection"],t,n)})).then(n.__importStar).then((function(e){e.checkTimezone()})),t.getChatVariants()}))},u.prototype.componentWillUnmount=function(){this.mounted=!1},u.prototype.getQuotaData=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t,o;return n.__generator(this,(function(n){switch(n.label){case 0:if((e=this.props.user).is_team)return[3,4];this.setState({accountSpaceUsage:{currentStatus:d.AccountSpaceUsageStatus.LOADING}}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.props.apiV2Client.ns("users").rpc("get_space_usage",void 0,{subjectUserId:e.id})];case 2:return t=n.sent(),this.mounted&&(o=t.allocation,this.setState({accountSpaceUsage:{currentStatus:d.AccountSpaceUsageStatus.READY,used:t.used,allocated:o.allocated}})),[3,4];case 3:return n.sent(),this.mounted&&this.setState({accountSpaceUsage:{currentStatus:d.AccountSpaceUsageStatus.NOT_APPLICABLE}}),[3,4];case 4:return[2]}}))}))},u.prototype.getChatVariants=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t;return n.__generator(this,(function(n){switch(n.label){case 0:return e=this.props.user,[4,i.SilentBackgroundRequest({url:"/portkey_chat_discoverability_variant",dataType:"json",subject_user:e.id})];case 1:return(t=n.sent())&&(this.widgetId=t.widgetId,this.setState({portkeyChatDiscoverability:t.variant})),[2]}}))}))},u.prototype.render=function(){var e=this.state,t=e.isDisabled,n=e.accountPhotoUrl,r=e.accountSpaceUsage,i=e.portkeyChatDiscoverability,a=this.props,u=a.hideInstallLink,c=a.showSettingsLink,l=a.featuresConfig,d=a.user,p=a.viewer,f=a.onClick,_=this.getUpsellLinks(this.props),m=_.quotaBarCTA,h=_.menuItemUpsells,g="V1"===i&&!!this.widgetId;return o.default.createElement(s.AccountMenuView,{user:d,viewer:p,accountPhotoUrl:n,disabled:t,accountSpaceUsage:r,quotaBarCTA:m,menuItemUpsells:h,showChatLink:g,hideInstallLink:u,showSettingsLink:c,onClickChatLink:this.handleChatLink,onClickChangeAvatar:this.handleChangeAvatar,onClickTrigger:f,featuresConfig:l})},u.defaultProps={accountPhotoUrl:null,hideInstallLink:!1,showSettingsLink:!0,apiV2Client:new l.UserApiV2Client},u=n.__decorate([a.eventHandler],u)})(o.default.Component),g=u.requireCssWithComponent(h,["/static/css/account_menu_common-vflUg8Q_l.css","/static/css/pagelet-vflMzK4D8.css","/static/css/spectrum/index.web-vfl_-DzRS.css"]);t.AccountMenu=g})),define("modules/clean/react/account_menu/account_menu_view",["require","exports","tslib","spectrum/account_menu","spectrum/button","spectrum/popover","react","modules/clean/react/account_menu/account_menu_util","modules/core/i18n","modules/clean/react/account_menu/account_menu_types","modules/clean/display_format","modules/clean/react/account_menu/profile_picture","modules/clean/react/growth/features/types","modules/clean/react/growth/logging_util","modules/clean/react/growth/features/util","modules/clean/react/growth/features/badge","modules/clean/analytics","modules/clean/react/retrieval_success_banner/util"],(function(e,t,n,o,r,i,a,s,u,c,l,d,p,f,_,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a);var v=function(){return null},y=function(e){return a.default.createElement(o.AccountMenuItem,n.__assign({target:"_blank",rel:"noopener",tabIndex:0},e))},b=function(e){return a.default.createElement(o.AccountMenuItem,{onClick:g.deleteSearchSuccessBannerSettings,href:s.getLogoutUrl(e.continuation),tabIndex:0},u.intl.formatMessage({defaultMessage:"Sign out"}))};t.ChatLink=function(e){return a.default.createElement(o.AccountMenuItem,{onClick:e.onClick,tabIndex:0},u.intl.formatMessage({defaultMessage:"Chat with Support"}))};var S=function(){h.GrowthEventsLogger.log("wb_profile_menu_install",{action:"click",location:"in_menu"})},A=function(){return a.default.createElement(y,{onClick:S,href:s.INSTALL_URL},u.intl.formatMessage({defaultMessage:"Install"}))};t.OverQuotaIcon=function(e){return a.default.createElement("svg",n.__assign({width:"24px",height:"24px",viewBox:"0 0 24 24"},e),a.default.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},a.default.createElement("g",{transform:"translate(-224.000000, -32.000000)"},a.default.createElement("g",{transform:"translate(224.000000, 32.000000)"},a.default.createElement("path",{d:"M16.4822397,17.9600934 C18.6953749,17.9600934 19.6038811,16.3972799 18.5180399,14.4810895 L13.960911,6.43909736 C12.8721172,4.51769655 11.1038811,4.52290698 10.0180399,6.43909736 L5.46091101,14.4810895 C4.37211722,16.4024903 5.27664243,17.9600934 7.4967112,17.9600934 L16.4822397,17.9600934 Z M12.9894755,15.9600934 L10.9894755,15.9600934 L10.9894755,13.9600934 L12.9894755,13.9600934 L12.9894755,15.9600934 L12.9894755,15.9600934 Z M12.9894755,12.9600934 L10.9894755,12.9600934 L10.9894755,8.96009345 L12.9894755,8.96009345 L12.9894755,12.9600934 L12.9894755,12.9600934 Z",id:"Shape"})))))},t.QuotaBar=function(e){var n=e.accountSpaceUsage;if(n.currentStatus===c.AccountSpaceUsageStatus.READY){var o=n.used,r=n.allocated,i=E(p.BadgePosition.RIGHT_OF_QUOTA,e.featuresConfig),s=a.default.createElement("div",null,u.intl.formatMessage({defaultMessage:"{count, plural, one{{used} of {allocated} used} other{{used} of {allocated} used}}"},{count:o,used:l.format_bytes(o),allocated:l.format_bytes(r)}),i);if(o<=r){return a.default.createElement("div",{className:"quota-bar-container"},a.default.createElement("div",{className:"quota-bar-empty"},a.default.createElement("div",{className:"quota-bar-used",style:{width:Math.min(100,o/r*100)+"%"}}),void 0),s,void 0,void 0)}return a.default.createElement("div",{className:"quota-bar-container quota-bar-container--over-quota"},a.default.createElement("div",{className:"quota-bar-empty"},a.default.createElement("div",{className:"quota-bar-used quota-bar-used--over-quota"})),s,a.default.createElement("span",{className:"ax-visually-hidden"},u.intl.formatMessage({defaultMessage:"Exceeded account quota"})),a.default.createElement(t.OverQuotaIcon,null))}return a.default.createElement("div",{className:"quota-bar-container"},a.default.createElement("div",{className:"quota-bar-empty"}),u.intl.formatMessage({defaultMessage:"Loading quota usage..."}))};var C=function(e){var t=e.quotaBarCTA,n=t.label,o=t.href;return h.GrowthEventsLogger.log("wb_profile_menu_upgrade_link",{action:"view",button_text:n,destination_url:o.split("?")[0],location:"in_menu"}),a.default.createElement("a",{className:"account-menu-upgrade-link",href:o,onClick:function(){h.GrowthEventsLogger.log("wb_profile_menu_upgrade_link",{action:"click",button_text:n,destination_url:o.split("?")[0],location:"in_menu"})}},n)},T=function(e){return a.default.createElement(y,{href:e.href},e.label)},R=function(){return a.default.createElement(o.AccountMenuItem,{href:s.SETTINGS_URL,tabIndex:0},u.intl.formatMessage({defaultMessage:"Settings"}))},w=function(e){var t=e.photoUrl?u.intl.formatMessage({defaultMessage:"Change photo"}):u.intl.formatMessage({defaultMessage:"Add photo"});return a.default.createElement("button",{className:"account-menu-avatar-link "+(e.className||""),onClick:e.changeAvatarCTA,tabIndex:0},t)},k=function(e){var n,i,s=e.accountSpaceUsage,u=e.quotaBarCTA,l=e.featuresConfig;s&&s.currentStatus!==c.AccountSpaceUsageStatus.NOT_APPLICABLE&&(n=a.default.createElement(t.QuotaBar,{accountSpaceUsage:s,featuresConfig:l})),null==u||l&&l.hideQuotaUpsellLink||(i=a.default.createElement(C,{quotaBarCTA:u}));var m=E(p.BadgePosition.UNDER_ACCOUNT_PHOTO,l),h=(function(e){if(!e||!e.menuItem)return null;var t=e.menuItem,n=e.project,r=t.logDisplayName,i=t.text;if(!i)return null;var s=_.getOnClickHandlerForCta(n,f.ComponentName.AVATAR_MENU,t);if(!s)return null;r&&f.logDisplay(n,f.ComponentName.AVATAR_MENU,{featureType:r});var u=E(p.BadgePosition.RIGHT_OF_MENU_ITEM,e);return a.default.createElement(o.AccountMenuItem,{className:"features-menu-item",onClick:s,onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.target.click())},tabIndex:0},i,u)})(l);return a.default.createElement("div",{className:"account-menu-user-summary"},a.default.createElement("div",{className:"account-menu-user-summary__avatar-and-name"},a.default.createElement(r.Button,{variant:"circular",className:"account-menu-user-summary__change-avatar",onClick:e.onClickChangeAvatar},a.default.createElement(d.ProfilePicture,{size:40,src:e.accountPhotoUrl})),a.default.createElement("div",{className:"account-menu-user-summary__display-name-and-link"},e.userDisplayName,a.default.createElement(w,{changeAvatarCTA:e.onClickChangeAvatar,photoUrl:e.accountPhotoUrl}))),m,n,i,h)};function E(e,t){if(!t||!t.badges)return null;var o=t.badges,r=t.project,i=null;switch(e){case p.BadgePosition.RIGHT_OF_MENU_ITEM:i=o.badgeRightOfMenuItem;break;case p.BadgePosition.RIGHT_OF_QUOTA:i=o.badgeRightOfQuota;break;case p.BadgePosition.UNDER_ACCOUNT_PHOTO:i=o.badgeUnderAccountPhoto}return!!i&&a.default.createElement(m.FeaturesBadge,n.__assign({className:"badge--"+e,project:r},i))}var P=(function(e){function s(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleTriggerClick=function(){var e=t.props,n=e.disabled,o=e.onClickTrigger;!n&&o&&(h.GrowthEventsLogger.log("wb_profile_menu",{action:"click",location:"in_menu"}),o())},t}return n.__extends(s,e),s.prototype.render=function(){var e=this.props,n=e.disabled,s=e.accountPhotoUrl,c=e.accountSpaceUsage,l=e.quotaBarCTA,p=e.menuItemUpsells,f=e.showChatLink,_=e.hideInstallLink,m=e.showSettingsLink,h=e.user,g=e.onClickChangeAvatar,y=e.onClickChatLink,S=e.featuresConfig,C=h.display_name;return a.default.createElement(i.Popover,{className:"account-menu",onSelection:v},a.default.createElement(i.PopoverTrigger,{disabled:n,"aria-label":u.intl.formatMessage({defaultMessage:"Account menu"})},a.default.createElement(r.Button,{tagName:"span",onClick:this.handleTriggerClick,disabled:n,variant:"circular"},a.default.createElement(d.ProfilePicture,{size:32,src:s}))),a.default.createElement(i.PopoverContent,{attachment:"right"},a.default.createElement(o.AccountMenuTitle,null,a.default.createElement(k,{accountPhotoUrl:s,userDisplayName:C,onClickChangeAvatar:g,accountSpaceUsage:c,quotaBarCTA:l,featuresConfig:S})),m&&a.default.createElement(R,null),!_&&a.default.createElement(A,null),p&&p.map(T),f&&a.default.createElement(t.ChatLink,{onClick:y}),a.default.createElement(o.AccountMenuSeparator,null),a.default.createElement(b,null)))},s})(a.default.PureComponent);t.AccountMenuView=P})),define("modules/clean/react/account_menu/profile_picture",["require","exports","tslib","react","modules/core/i18n","modules/clean/static_urls"],(function(e,t,n,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o);var a=i.static_url("/static/images/avatar/faceholder-vflmhyJKO.svg");t.ProfilePicture=function(e){return o.default.createElement("img",{className:"mc-avatar-image",style:{height:e.size,width:e.size},src:e.src||a,alt:r.intl.formatMessage({defaultMessage:"Account photo"})})}})),define("modules/clean/react/account_menu/account_menu_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.LOADING=1]="LOADING",e[e.READY=2]="READY",e[e.NOT_APPLICABLE=3]="NOT_APPLICABLE"})(t.AccountSpaceUsageStatus||(t.AccountSpaceUsageStatus={})),(function(e){e.SETTINGS="settings",e.INSTALL="install",e.CHAT="chat",e.LOGOUT="logout"})(t.AccountMenuSelectionOption||(t.AccountMenuSelectionOption={})),(function(e){e[e.ALWAYS=0]="ALWAYS",e[e.STANDARD=50]="STANDARD",e[e.ALMOST_FULL=80]="ALMOST_FULL",e[e.OVERQUOTA=100]="OVERQUOTA"})(t.AccountMenuQuotaBarBreakpoints||(t.AccountMenuQuotaBarBreakpoints={})),(function(e){e.UPGRADE="UPGRADE",e.GET_MORE_SPACE="GET_MORE_SPACE"})(t.UpgradeText||(t.UpgradeText={}))})),define("modules/clean/react/account_menu/account_menu_util",["require","exports","tslib","modules/clean/analytics","modules/clean/react/account_menu/account_menu_types","modules/constants/trademark","modules/core/browser","modules/core/i18n","modules/core/uri"],(function(e,t,n,o,r,i,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),t.getLogoutUrl=function(e){return new u.URI({scheme:"https",authority:"www.dropbox.com",path:"/logout",query:e?{cont:e}:void 0}).toString()},t.INSTALL_URL=new u.URI({scheme:"https",authority:"www.dropbox.com",path:"/install"}).toString(),t.SETTINGS_URL=new u.URI({scheme:"https",authority:"www.dropbox.com",path:"/account"}).toString(),t.UPGRADE_URL=new u.URI({scheme:"https",authority:"www.dropbox.com",path:"/plans",query:{trigger:"direct"}}).toString(),t.getAccountSpaceUsage=function(e,t){return t.serialized_sku_content.has_unlimited_space?{currentStatus:r.AccountSpaceUsageStatus.NOT_APPLICABLE}:"other"===e.allocation[".tag"]?{currentStatus:r.AccountSpaceUsageStatus.NOT_APPLICABLE}:{currentStatus:r.AccountSpaceUsageStatus.READY,used:e.used,allocated:e.allocation.allocated}},t.upsellLinks={UPGRADE_PLANS:{label:s.intl.formatMessage({defaultMessage:"Upgrade"}),href:t.UPGRADE_URL},TRY_BUSINESS:{label:s.intl.formatMessage({defaultMessage:"Try {trademark_business}"},{trademark_business:i.TRADEMARK_BUSINESS}),href:new u.URI({scheme:"https",authority:"www.dropbox.com",path:"/business/try",query:{_tk:"dropdown"}}).toString()}},t.handleChangeAvatar=function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,n){e(["modules/clean/account_photo_modal/controller"],t,n)})).then(n.__importStar)];case 1:return t.sent().AccountPhotoModalController.show(),[2]}}))}))},t.handleMenuToggle=function(e){e.isOpen&&o.GrowthEventsLogger.log("wb_profile_menu",{action:"click",location:"in_menu",version:"v2"})},t.handleInstallClick=function(){o.GrowthEventsLogger.log("wb_profile_menu_install",{action:"click",location:"in_menu",version:"v2"})},t.getUpgradeButtonText=function(e){return e===r.UpgradeText.UPGRADE?s.intl.formatMessage({defaultMessage:"Upgrade"}):s.intl.formatMessage({defaultMessage:"Get more space"})},t.getUpsellText=function(e,t){var n=void 0;return t>=r.AccountMenuQuotaBarBreakpoints.OVERQUOTA?n=e===r.UpgradeText.UPGRADE?s.intl.formatMessage({defaultMessage:"Free up space or upgrade now"}):s.intl.formatMessage({defaultMessage:"Your account is out of storage"}):t>=r.AccountMenuQuotaBarBreakpoints.ALMOST_FULL&&(n=e===r.UpgradeText.UPGRADE?s.intl.formatMessage({defaultMessage:"Upgrade soon to get more space"}):s.intl.formatMessage({defaultMessage:"Youâ€™re almost out of storage"})),n},t.handleUpgradeButtonView=function(e){o.GrowthEventsLogger.log("wb_profile_menu_upgrade_link",{action:"view",button_text:e,destination_url:t.UPGRADE_URL,location:"in_menu",version:"v2"})},t.handleUpgradeButtonClick=function(e){o.GrowthEventsLogger.log("wb_profile_menu_upgrade_link",{action:"click",button_text:e,location:"in_menu",version:"v2"}),a.redirect(t.UPGRADE_URL)}})),define("modules/clean/react/growth/feature_tour_modal/constants",["require","exports","modules/clean/react/growth/features/types"],(function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.UPLOAD="upload",e.SHARING="sharing",e.ORGANIZING="organizing",e.HELP="help"})(o=t.TopicKey||(t.TopicKey={})),(function(e){e.LIST="list",e.SINGLE="single"})(t.TopicType||(t.TopicType={})),(function(e){e.IMAGE="image",e.VIDEO="video"})(t.VisualAssetType||(t.VisualAssetType={})),(function(e){e.CLOUD="cloud",e.ORCHID="orchid",e.WHEAT="wheat",e.WHITE="white"})(t.BackgroundColor||(t.BackgroundColor={})),t.getTopicKeys=function(e){switch(e){case n.ProjectType.WEB_PLUS_TRIALS:case n.ProjectType.POT_OF_GOLD:case n.ProjectType.WEB_PLUS_DIRECT:case n.ProjectType.NCCT_PLUS_TRIALS:case n.ProjectType.NCCT_PLUS_TRIALS_ENABLE_AUTO_CONVERT:case n.ProjectType.PLATFORM_PLUS_TRIALS_30D:return[o.UPLOAD,o.ORGANIZING,o.SHARING,o.HELP];default:return[]}}})),define("modules/clean/react/growth/feature_tour_modal/feature_tour_modal_loader",["require","exports","tslib","react","modules/clean/react/async/loadable","modules/clean/react/growth/feature_tour_modal/constants","modules/clean/react/growth/logging_util"],(function(e,t,n,o,r,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o);var s=r.Loadable({loader:function(){return new Promise((function(t,n){e(["modules/clean/react/growth/feature_tour_modal/components/feature_tour_modal"],t,n)})).then(n.__importStar).then((function(e){return e.FeatureTourModal}))}});t.renderFeatureTourModal=function(t,r,u){var c=i.getTopicKeys(t);return c.length?new Promise((function(t,n){e(["modules/clean/react/modal"],t,n)})).then(n.__importStar).then((function(e){e.Modal.showInstance(o.default.createElement(s,{topicKeys:c,className:r,handleDismiss:u,loggingProject:t,loggingComponentName:a.ComponentName.FEATURE_TOUR_MODAL}))})):null}})),define("modules/clean/react/growth/features/badge",["require","exports","tslib","react","modules/clean/react/growth/features/types","modules/clean/react/growth/logging_util","modules/clean/react/css"],(function(e,t,n,o,r,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.props.text&&i.logDisplay(this.props.project,i.ComponentName.AVATAR_MENU,{featureType:(this.props.text+"_badge").toLowerCase()})},t.prototype.render=function(){var e=this.props,t=e.className,n=e.color,r=e.text;return!!r&&o.default.createElement("span",{className:"growth-features-badge badge badge--color-"+n+" "+t},r)},t.defaultProps={className:"",color:r.BadgeColor.WHITE},t})((o=n.__importDefault(o)).default.PureComponent);t.FeaturesBadgeComponent=s,t.FeaturesBadge=a.requireCssWithComponent(s,["/static/css/react/badge-vfls8DI0O.css","/static/css/react/growth/features/badge-vflgUaujS.css"])})),define("modules/clean/react/growth/features/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.NEON_GREEN="neon-green",e.STONE_FORTY="stone-forty",e.SQUASH="squash",e.PINK="pink",e.WHITE="white"})(t.BadgeColor||(t.BadgeColor={})),(function(e){e.RIGHT_OF_QUOTA="right-of-quota",e.RIGHT_OF_MENU_ITEM="right-of-menu-item",e.UNDER_ACCOUNT_PHOTO="under-account-photo"})(t.BadgePosition||(t.BadgePosition={})),(function(e){e.FEATURE_TOUR_MODAL="feature_tour_modal"})(t.ModalType||(t.ModalType={})),(function(e){e.SHOW_FEATURE_TOUR_MODAL="show_feature_tour_modal"})(t.OnClickType||(t.OnClickType={})),(function(e){e.NCCT_PLUS_TRIALS="ncct_plus_trials",e.NCCT_PLUS_TRIALS_ENABLE_AUTO_CONVERT="ncct_plus_trials_enable_auto_convert",e.PLATFORM_PLUS_TRIALS_30D="platform_plus_trials_30d",e.POT_OF_GOLD="pot_of_gold",e.WEB_FAMILY_DIRECT="web_plus_direct",e.WEB_PLUS_DIRECT="web_plus_direct",e.WEB_PLUS_TRIALS="web_plus_trials"})(t.ProjectType||(t.ProjectType={}))})),define("modules/clean/react/growth/features/util",["require","exports","tslib","modules/core/browser","modules/clean/server_side_client_view_bridge","modules/clean/react/growth/logging_util","modules/clean/react/growth/features/types","modules/clean/react/growth/util","modules/clean/react/growth/feature_tour_modal/feature_tour_modal_loader"],(function(e,t,n,o,r,i,a,s,u){"use strict";function c(e,t,n){var o=s.getActiveUserId();switch(n.onClickType){case a.OnClickType.SHOW_FEATURE_TOUR_MODAL:return function(){n.moduleName&&o&&s.markModuleAsCompleted(o,n.moduleName),i.logCtaClick(e,t,i.CtaType.OPEN_MODAL,{modalType:a.ModalType.FEATURE_TOUR_MODAL}),u.renderFeatureTourModal(e)}}}function l(e,t,n,a,s,u){if(i.logCtaClick(t,n,i.CtaType.OPEN_EXTERNAL_LINK,{href:e}),r.GetPlatform()){var c=u?r.ViewManagementClose:void 0;s?r.OpenCredentialedBrowser(e,s,c):r.OpenUncredentialedBrowser(e,c)}else a?o.open_tab(e):o.redirect(e)}Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),r=n.__importStar(r),t.getOnClickHandler=c,t.getOnClickHandlerForCta=function(e,t,n,o){if(n.href||n.onClick||n.onClickType)return n.onClickType?c(e,t,n):n.onClick?n.onClick:function(){return l(n.href||"#",e,t,!1,o,!0)}},t.openHref=l})),define("modules/clean/react/growth/logging_util",["require","exports","tslib","modules/core/browser","modules/clean/analytics"],(function(e,t,n,o,r){"use strict";var i;function a(e,t,i,a,s){var u="growth_"+t+"_"+i,c={path:o.get_href(),project:e};return r.ProEventsLogger.log(u,n.__assign(n.__assign({},a),c),s,!1,e)}Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),(function(e){e.AJAX_ERROR="ajax_error",e.AJAX_SUCCESS="ajax_success",e.COMPLETED="completed",e.CTA_CLICKED="cta_clicked",e.DISMISSED="dismissed",e.DISPLAYED="displayed",e.RENDER_ERROR="render_error",e.TASK_COMPLETED="task_completed",e.TASK_EXPANDED="task_expanded"})(i||(i={})),(function(e){e.AUTO_RENEW_TERMS="auto_renew_terms",e.AVATAR_MENU="avatar_menu",e.CANCEL_TRIAL_BIZ_INVITE="cancel_trial_biz_invite_modal",e.CANCEL_TRIAL_EXPECTATIONS="cancel_trial_expectations_modal",e.CANCEL_TRIAL_SURVEY="cancel_trial_survey_modal",e.DIRECT_PURCHASE_MODAL="direct_purchase_modal",e.FEATURE_TOUR_MODAL="feature_tour_modal",e.ONBOARDING_SIDEBAR="onboarding_sidebar",e.START_TRIAL_MODAL="start_trial_modal",e.TRIAL_BANNER="trial_banner"})(t.ComponentName||(t.ComponentName={})),(function(e){e.CONFIRM="confirm",e.CONTINUE="continue",e.OPEN_EXTERNAL_LINK="open_external_link",e.OPEN_MODAL="open_modal"})(t.CtaType||(t.CtaType={})),(function(e){e.HELP="help",e.ORGANIZING="organizing",e.SHARING="sharing",e.UPLOAD="upload"})(t.FeatureType||(t.FeatureType={})),(function(e){e.CANCEL_TRIAL="cancel_trial",e.START_TRIAL="start_trial",e.TRANSITION_PLAN="transition_plan",e.UPGRADE_TRIAL="upgrade_trial"})(t.RequestType||(t.RequestType={})),t.logAjaxError=function(e,t,o,r,s){var u=n.__assign(n.__assign({},r),{requestType:o});return a(e,t,i.AJAX_ERROR,u,s)},t.logAjaxSuccess=function(e,t,o,r,s){var u=n.__assign(n.__assign({},r),{requestType:o});return a(e,t,i.AJAX_SUCCESS,u,s)},t.logCtaClick=function(e,t,o,r,s){var u=n.__assign(n.__assign({},r),{cta:o});return a(e,t,i.CTA_CLICKED,u,s)},t.logDismiss=function(e,t,n,o){return a(e,t,i.DISMISSED,n,o)},t.logDisplay=function(e,t,n,o){return a(e,t,i.DISPLAYED,n,o)},t.logCompleted=function(e,t,o,r){return a(e,t,i.COMPLETED,n.__assign({},o),r)},t.logRenderError=function(e,t,n,o){return a(e,t,i.RENDER_ERROR,n,o)},t.logTaskCompleted=function(e,t,o,r,s){return a(e,t,i.TASK_COMPLETED,n.__assign(n.__assign({},r),{task:o}),s)},t.logTaskExpanded=function(e,t,o,r,s){return a(e,t,i.TASK_EXPANDED,n.__assign(n.__assign({},r),{task:o}),s)}})),define("modules/clean/react/growth/trials/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.CANCEL_TRIAL_BIZ_INVITE="cancel_trial_biz_invite_modal",e.CANCEL_TRIAL_EXPECTATIONS="cancel_trial_expectations_modal",e.CANCEL_TRIAL_SURVEY="cancel_trial_survey_modal"})(t.ModalType||(t.ModalType={})),(function(e){e.NCCT_PLUS_TRIALS="ncct_plus_trials",e.NCCT_PLUS_TRIALS_ENABLE_AUTO_CONVERT="ncct_plus_trials_enable_auto_convert",e.PLATFORM_PLUS_TRIALS_30D="platform_plus_trials_30d",e.RIGHTSIZING="rightsizing",e.WEB_PLUS_TRIALS="web_plus_trials"})(t.ProjectType||(t.ProjectType={})),(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.TRANSITIONS_TRIAL=1]="TRANSITIONS_TRIAL",e[e.PLATFORM_TRIAL=2]="PLATFORM_TRIAL"})(t.TrialSource||(t.TrialSource={}))})),define("modules/clean/react/maestro/layout/header_conditions",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showAccountMenu=function(e,t){return!e.is_team_assume_user_session&&!t.is_guest_admin}})),define("modules/clean/react/maestro/layout/non_pagelet_top_menu_container",["require","exports","tslib","react","modules/clean/react/account_menu/account_menu","modules/clean/react/css","modules/clean/react/maestro/layout/header_conditions","modules/clean/react/maestro/layout/top_menu_container","modules/clean/react/user_notifications/dropdown","modules/clean/viewer"],(function(e,t,n,o,r,i,a,s,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderTopMenus=function(e){var t;e&&(t=o.default.createElement(r.AccountMenu,{user:this.props.user,viewer:this.props.viewer,dropdownHorizontalDisplacement:-40}));var n=this.props.user.is_guest_admin?"":o.default.createElement(u.UserNotificationsDropdown,{isPagelet:!1});return[o.default.createElement("div",{className:"notifications-widget-container",key:"notifications-widget"},n),o.default.createElement("div",{className:"account-menu-widget-container",key:"account-menu-widget"},t)]},t.prototype.render=function(){var e=a.showAccountMenu(this.props.viewer,this.props.user),t=e?"":"top-menu-container--account-menu-hidden",r=n.__assign(n.__assign({},this.props),{rightContent:this.renderTopMenus(e),classNames:t});return o.default.createElement(s.TopMenuContainer,n.__assign({},r))},t.defaultProps={viewer:c.Viewer.get_viewer()},t})((o=n.__importDefault(o)).default.Component);t.NonPageletTopMenuContainer=i.requireCssWithComponent(l,["/static/css/pagelet-vflMzK4D8.css"],[s.TopMenuContainer,u.UserNotificationsDropdown])})),define("modules/clean/react/maestro/layout/nonpagelet_header",["require","exports","tslib","react","modules/clean/react/css","modules/clean/viewer","modules/clean/react/maestro/layout/header","modules/clean/react/maestro/layout/non_pagelet_top_menu_container"],(function(e,t,n,o,r,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getUser=function(){var e=i.Viewer.get_viewer().get_users();if(0===e.length)throw new Error("No logged in user detected. This header can only be used with a logged in user.");return e[0]},t.prototype.render=function(){var e=o.default.createElement(s.NonPageletTopMenuContainer,n.__assign({},this.props,{user:this.getUser()}));return o.default.createElement("div",{className:"maestro"},o.default.createElement("div",{className:"maestro-header--without-nav"},o.default.createElement("header",{className:"maestro-header page-header__shadow"},o.default.createElement("div",{className:"page-header"},o.default.createElement(a.MaestroHeaderLogo,null),o.default.createElement("div",{className:"maestro-header--right-content"},e)))))},t.defaultProps={searchVariant:null,isSearchBarExpanded:!1},t})((o=n.__importDefault(o)).default.Component),c=r.requireCssWithComponent(u,["/static/css/maestro_header_without_nav-vfl83CrRU.css"]);t.NonPageletMaestroHeader=c})),define("modules/clean/loggers/notification_logger",["require","exports","tslib","modules/clean/ajax","modules/clean/react/user_notifications/models"],(function(e,t,n,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),t.NotificationLocations={TRAY:"home",HOME_PAGE:"home_page"};var i=(function(){function e(){}return e.logReceive=function(t){for(var n=[],o=0,r=t;o<r.length;o++){var i=r[o];n.push(e.getCommonEventData("receive",i))}e.log(n)},e.logRender=function(t,n,o){var r=[];t.forEach((function(t,i){var a=e.getCommonEventData("render",t);a.location=o,a.location_index=n+i,r.push(a)})),e.log(r)},e.logAction=function(t,n,o){var r=e.getCommonEventData("action",t);r.action_taken=n,o&&(r.location=o),e.log([r])},e.logMarkAsRead=function(t,n){for(var o=[],r=0,i=t;r<i.length;r++){var a=i[r],s=e.getCommonEventData("mark_read",a);s.location=n,o.push(s)}e.log(o)},e.log=function(e){0!==e.length&&o.SilentBackgroundRequest({url:"/log/notif_events",data:{event_list:JSON.stringify(e)}})},e.getCommonEventData=function(e,t){return{event_name:e,type_id:t.typeId,campaign_id:t.campaignId,campaign_version:t.campaignVersion,instance_id:parseInt(t.id,10),status:r.NotificationStatusStrings[t.status],seen_state:t.seenState,target_object_key:t.targetObjectKey}},e})();t.NotificationLogger=i})),define("modules/clean/react/user_notifications/actions",["require","exports","tslib","modules/clean/bolt","modules/clean/loggers/notification_logger","modules/clean/loggers/notification_tray_logger","modules/clean/react/user_notifications/api","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/dispatcher","modules/clean/react/user_notifications/models","modules/clean/react/user_notifications/store","modules/clean/referrer_cleansing_redirect"],(function(e,t,n,o,r,i,a,s,u,c,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),a=n.__importStar(a),d=n.__importStar(d);var p=new((function(){function t(){var e=this;this.onUserNotificationUpdate=function(){e.load().then((function(t){if(t){var n=e.getBoltChannelStates(t);e.boltClient.update_states(n)}}),(function(){}))},this.userNotificationRefreshCallback=function(){e.load().then((function(t){if(t){e.boltClient.unsubscribe();var n=e.getBoltChannelStates(t);n.length>0&&(e.boltClient=new o.BoltClient(n,e.onUserNotificationUpdate,e.userNotificationRefreshCallback),e.boltClient.start())}}),(function(){}))}}return t.prototype.asyncSharingAction=function(t){new Promise((function(t,n){e(["modules/clean/react/user_notifications/sharing_actions"],t,n)})).then(n.__importStar).then(t)},t.prototype.asyncGroupAction=function(t){new Promise((function(t,n){e(["modules/clean/react/user_notifications/group_actions"],t,n)})).then(n.__importStar).then(t)},t.prototype.load=function(){return u.userNotificationsDispatcher.dispatch({type:s.ActionTypes.LOAD_REQUEST}),a.getAll(l.userNotificationsStore.getCursor(),this.activeUserOnlyMode).then((function(e){var t=[];return t=t.concat(e.notifications),r.NotificationLogger.logReceive(t),u.userNotificationsDispatcher.dispatch({type:s.ActionTypes.LOAD_SUCCESS,data:e}),e}),(function(){u.userNotificationsDispatcher.dispatch({type:s.ActionTypes.LOAD_FAILURE})}))},t.prototype.loadOnceAndWatch=function(e){var t=this;this.hasLoadedOnce||(this.hasLoadedOnce=!0,this.activeUserOnlyMode=null!=e&&e,this.load().then((function(e){e&&t.watch(e)}),(function(){})))},t.prototype.acknowledge=function(e){u.userNotificationsDispatcher.dispatch({type:s.ActionTypes.ACKNOWLEDGEMENT_REQUEST_SINGLE,data:{notifications:[e]}}),a.ack(e)},t.prototype.markAllAsSeen=function(){var e=l.userNotificationsStore.getUnseen();0!==e.length&&(a.markAsSeen(e),u.userNotificationsDispatcher.dispatch({type:s.ActionTypes.MARK_AS_SEEN_REQUEST}))},t.prototype.watch=function(e){var t=this.getBoltChannelStates(e);t.length>0&&(this.boltClient=new o.BoltClient(t,this.onUserNotificationUpdate,this.userNotificationRefreshCallback),this.boltClient.start())},t.prototype.getBoltChannelStates=function(e){var t=[];for(var n in e.cursor)if(e.cursor.hasOwnProperty(n)){var r=null,i=window.ensemble;if(i&&i.viewer&&(r=i.viewer.getActiveUser()),!this.activeUserOnlyMode||(null!=r?r.userId:null)===parseInt(n,10)){var a=new o.SignedChannelState("user_notification",n,e.cursor[n],e.boltToken[n]);t.push(a)}}return t},t.prototype.acknowledgeAll=function(){0!==l.userNotificationsStore.getUnacknowledgedCount()&&(i.logMarkAllAsRead(),r.NotificationLogger.logMarkAsRead(l.userNotificationsStore.getUnacknowledged(),r.NotificationLocations.TRAY),u.userNotificationsDispatcher.dispatch({type:s.ActionTypes.ACKNOWLEDGEMENT_REQUEST}),a.ackAll(this.activeUserOnlyMode))},t.prototype.viewNotifications=function(){this.markAllAsSeen()},t.prototype.actionPerformed=function(e,t){r.NotificationLogger.logAction(e,t),e.isUnread&&this.acknowledge(e)},t.prototype.triggerGenericLegacyNotificationAction=function(e){this.actionPerformed(e,"click")},t.prototype.dismissLegacySharingNotification=function(e,t){this.actionPerformed(e,"button_1"),this.asyncSharingAction((function(e){e.registerDismiss(t)}))},t.prototype.mountFromLegacySharingNotification=function(e,t){this.actionPerformed(e,"button_0"),this.asyncSharingAction((function(e){e.registerMount(t)}))},t.prototype.upgradeToMountFromLegacySharingNotification=function(e){this.actionPerformed(e,"button_0"),this.asyncSharingAction((function(e){e.upgradeToMount()}))},t.prototype.triggerBluenoteAction=function(e,t,n,o){this.actionPerformed(t,o),n.actionType===c.BluenoteActionTypes.OpenUrl?(e.preventDefault(),this.performBluenoteOpenUrlAction(n.params)):n.actionType===c.BluenoteActionTypes.MountSharedFolder?this.asyncSharingAction((function(e){e.performBluenoteMountSharedFolder(t,n.params)})):n.actionType===c.BluenoteActionTypes.ApproveGroupJoinRequest?this.asyncGroupAction((function(e){e.performBluenoteApproveGroupJoinRequestAction(t,n.params)})):n.actionType===c.BluenoteActionTypes.RemoveGroupJoinRequest&&this.asyncGroupAction((function(e){e.performBluenoteRemoveGroupJoinRequestAction(t,n.params)}))},t.prototype.performBluenoteOpenUrlAction=function(e){e.urlPath&&d.redirect(e.urlPath)},t})());t.default=p})),define("modules/clean/react/user_notifications/api",["require","exports","tslib","jquery","modules/clean/ajax","modules/clean/react/user_notifications/api_helper","modules/clean/edison/active_user_id"],(function(e,t,n,o,r,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o),r=n.__importStar(r);t.getAll=function(e,t){void 0===e&&(e=null),void 0===t&&(t=!1);var n,s={count:100,template_version:5};if(null!=e&&(s.last_received_nid_by_user_id=JSON.stringify(e)),t){if(null===e){var u=window.__REGISTER_NOTIFICATIONS_PREFETCH_HANDLER;if(u)return u.prefetchDeferred||(u.prefetchDeferred=o.default.Deferred(),u((function(e){u.prefetchDeferred.resolve(i.parseGetAllResponse(e))}),(function(){return null}))),u.prefetchDeferred}n=r.SilentBackgroundRequest({url:"/web/notifications/retrieve_user",data:s,subject_user:a.getActiveUserId(),dataType:"json"})}else n=r.SilentBackgroundRequest({url:"/web/notifications/retrieve",data:s,dataType:"json"});return n.then(i.parseGetAllResponse)},t.ackAll=function(e){return void 0===e&&(e=!1),(e?r.SilentBackgroundRequest({url:"/web/notifications/ack_all_user",subject_user:a.getActiveUserId(),dataType:"json"}):r.SilentBackgroundRequest({url:"/web/notifications/ack_all",dataType:"json"})).then((function(e){return e.map(i.userNotificationDeserializer)}))},t.ack=function(e){r.SilentBackgroundBeaconRequest({url:"/web/notifications/ack",subject_user:e.userId,data:{nids:JSON.stringify([e.id])},dataType:"json"})},t.markAsSeen=function(e){for(var t={},n=0,o=e;n<o.length;n++){var i=o[n];i.userId&&i.id&&(t[i.userId]||(t[i.userId]=[])).push(i.id)}var a={nids_by_user_id:JSON.stringify(t)};r.SilentBackgroundRequest({url:"/web/notifications/mark_seen",data:a,dataType:"json"})}})),define("modules/clean/react/user_notifications/dispatcher",["require","exports","modules/clean/flux/dispatcher"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userNotificationsDispatcher=n.Dispatcher})),define("modules/clean/react/user_notifications/store",["require","exports","tslib","external/lodash","modules/clean/flux/flux_store","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/dispatcher","modules/clean/react/user_notifications/models","modules/clean/react/user_notifications/api_helper"],(function(e,t,n,o,r,i,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o);var c=(function(e){function t(t){var n=e.call(this,t)||this;return n.isAcknowledged=function(e){return e.isRead},n.markNotificationAsReadLocally=function(e){e.isUnread&&(e.status=s.NotificationStatuses.Read)},n.isLoadingFlag=!1,n.userNotifications=[],n}return n.__extends(t,e),t.prototype.isLoading=function(){return this.isLoadingFlag},t.prototype.getActionableCount=function(){return this.getUnseenInternal().length},t.prototype.getUnacknowledgedCount=function(){return this.getUnacknowledgedInternal().length},t.prototype.getCursor=function(){return this.cursor},t.prototype.getAll=function(){return this.userNotifications},t.prototype.getAllVisible=function(){return this.userNotifications.filter((function(e){return!e.isInvisible}))},t.prototype.getUnacknowledged=function(){return this.getUnacknowledgedInternal()},t.prototype.getUnacknowledgedInternal=function(){return this.userNotifications.filter((function(e){return e.isUnread}))},t.prototype.getUnseen=function(){return this.getUnseenInternal()},t.prototype.getUnseenInternal=function(){return this.userNotifications.filter((function(e){return!e.isSeen}))},t.prototype.onLoadRequest=function(){this.isLoadingFlag||(this.isLoadingFlag=!0,this.__emitChange())},t.prototype.onLoadSuccess=function(e){if(this.isLoadingFlag&&(this.isLoadingFlag=!1,this.__emitChange()),o.isEqual(e.cursor,this.cursor)||(this.cursor=e.cursor,this.__emitChange()),e.notifications.length>0){var t={};e.notifications.concat(this.userNotifications).forEach((function(e){t[e.key]||(t[e.key]=e)})),this.userNotifications=o.values(t).sort(u.userNotificationComparator),this.__emitChange()}},t.prototype.onLoadFailure=function(){this.isLoadingFlag&&(this.isLoadingFlag=!1,this.__emitChange())},t.prototype.onAcknowledgementRequest=function(){this.userNotifications.forEach(this.markNotificationAsReadLocally),this.__emitChange()},t.prototype.onAcknowledgementRequestSingle=function(e){this.markNotificationAsReadLocally(e),this.__emitChange()},t.prototype.onMarkAsSeenRequest=function(){this.userNotifications.forEach((function(e){e.isSeen||(e.seenState=s.NotificationSeenState.Seen)})),this.__emitChange()},t.prototype.__onDispatch=function(e){switch(e.action.type){case i.ActionTypes.LOAD_REQUEST:this.onLoadRequest();break;case i.ActionTypes.LOAD_SUCCESS:this.onLoadSuccess(e.action.data);break;case i.ActionTypes.LOAD_FAILURE:this.onLoadFailure();break;case i.ActionTypes.ACKNOWLEDGEMENT_REQUEST:this.onAcknowledgementRequest();break;case i.ActionTypes.ACKNOWLEDGEMENT_REQUEST_SINGLE:this.onAcknowledgementRequestSingle(e.action.data.notifications[0]);break;case i.ActionTypes.MARK_AS_SEEN_REQUEST:this.onMarkAsSeenRequest()}},t})(r.FluxStore);t.UserNotificationsStore=c,t.userNotificationsStore=new c(a.userNotificationsDispatcher)})),define("modules/clean/react/user_notifications/avatar_icon",["require","exports","tslib","react","modules/clean/avatar/initials_avatar","modules/clean/avatar/size"],(function(e,t,n,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(t){var n=e.call(this,t)||this;n.thumbRequestId=null;var o=null,r=n.props.avatarIconRecord;return null!=r.avatarUrl&&(o=n.props.thumbStore.get_thumb(r.avatarUrl)),n.state={avatarImage:o},n}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.bindAvatarUrl(this.props)},t.prototype.componentWillUnmount=function(){this.unbindAvatarUrl()},t.prototype.componentWillReceiveProps=function(e){var t=this.props.avatarIconRecord,n=e.avatarIconRecord;t.avatarUrl!==n.avatarUrl&&(this.unbindAvatarUrl(),this.bindAvatarUrl(e))},t.prototype.bindAvatarUrl=function(e){var t=this,n=e.avatarIconRecord;null!=n.avatarUrl&&(this.thumbRequestId=e.thumbStore.bind_url(n.avatarUrl,{onSuccess:function(){var o=e.thumbStore.get_thumb(n.avatarUrl);t.setState({avatarImage:o})}}))},t.prototype.unbindAvatarUrl=function(){this.thumbRequestId&&(this.props.thumbStore.unbind_url(this.thumbRequestId),this.thumbRequestId=null)},t.prototype.render=function(){var e=this.props.avatarIconRecord;return null!=this.state.avatarImage?o.default.createElement("img",{className:this.props.className,src:this.state.avatarImage,alt:"",width:this.props.size,height:this.props.size}):o.default.createElement(r.InitialsAvatarWithColorDerivedFromName,{name:e.avatarInitials,dimension:this.props.size,initials:e.avatarInitials,shape:"CIRCLE",optionalClass:this.props.className})},t.displayName="AvatarIcon",t.defaultProps={size:i.AVATAR_DIMENSION_BY_SIZE.MEDIUM},t})((o=n.__importDefault(o)).default.Component);t.AvatarIcon=a})),define("modules/clean/react/user_notifications/dropdown",["require","exports","tslib","external/lodash","react","modules/clean/accessibility/tabbable","modules/clean/loggers/notification_logger","modules/clean/loggers/notification_tray_logger","modules/clean/react/css","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/dropdown_bell","modules/clean/react/user_notifications/shared/tray_chrome","modules/clean/react/user_notifications/renderer","modules/clean/react/user_notifications/store","spectrum/popover","modules/core/i18n"],(function(e,t,n,o,r,i,a,s,u,c,l,d,p,f,_,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),r=n.__importDefault(r),i=n.__importDefault(i),s=n.__importStar(s),c=n.__importDefault(c);var h=(function(t){function u(e){var n=t.call(this,e)||this;return n.onTrayMount=function(){s.logTrayOpen(n.state.actionableCount),c.default.viewNotifications()},n.logRenderWrapper=function(e,t){a.NotificationLogger.logRender(e,t,a.NotificationLocations.TRAY)},n.onMenuToggle=function(e){var t=e.isOpen;n.setState({isOpen:t}),u.requireAsyncModules()},n.state={actionableCount:f.userNotificationsStore.getActionableCount(),notifications:f.userNotificationsStore.getAllVisible(),isStoreLoading:f.userNotificationsStore.isLoading(),isDisabled:!0,isOpen:!1},n}return n.__extends(u,t),u.prototype.componentDidMount=function(){c.default.loadOnceAndWatch(this.props.isPagelet),this.removeStoreListener=f.userNotificationsStore.addListener(this.onUpdateFromStore.bind(this)),this.onUpdateFromStore();var e=new p.NotificationRenderer;this.notificationRenderFunc=e.renderNotification.bind(e),this.setState((function(e,t){return e.isDisabled=!1,e})),new i.default},u.prototype.componentWillUnmount=function(){this.removeStoreListener()},u.prototype.onUpdateFromStore=function(){this.setState((function(e,t){return e.actionableCount=f.userNotificationsStore.getActionableCount(),e.notifications=f.userNotificationsStore.getAllVisible(),e.isStoreLoading=f.userNotificationsStore.isLoading(),e}))},u.prototype.render=function(){var e=r.default.createElement("div",{id:"event-feed-container"},r.default.createElement("div",{id:"event-feed"},r.default.createElement(d.NotificationsTrayChrome,{unreadSectionTitle:m.intl.formatMessage({defaultMessage:"Unread"}),readSectionTitle:m.intl.formatMessage({defaultMessage:"Recent"}),notifications:this.state.notifications,markAllAsReadButtonTitle:m.intl.formatMessage({defaultMessage:"Mark all as read"}),markAllAsReadAction:c.default.acknowledgeAll,isLoading:this.state.isStoreLoading,loadingMessage:m.intl.formatMessage({defaultMessage:"Loading ..."}),emptyMessage:m.intl.formatMessage({defaultMessage:"You donâ€™t have any notifications yet."}),notifRenderFunc:this.notificationRenderFunc,notifLogRenderFunc:this.logRenderWrapper,onTrayMount:this.onTrayMount}))),t=this.state.actionableCount;return r.default.createElement(_.Popover,{onSelection:o.noop,onMenuToggle:this.onMenuToggle},r.default.createElement(_.PopoverTrigger,{"aria-label":t>0?m.intl.formatMessage({defaultMessage:"Notifications menu, with new notifications"}):m.intl.formatMessage({defaultMessage:"Notifications menu"}),className:"notification-button"},r.default.createElement(l.UserNotificationsDropdownBell,{actionableCount:t,isSelected:this.state.isOpen})),r.default.createElement(_.PopoverContent,{attachment:"right",className:"notifications-popover-content"},r.default.createElement(_.PopoverContentTitle,null,m.intl.formatMessage({defaultMessage:"Notifications"})),r.default.createElement("div",{className:"notifications-dropdown"},e)))},u.displayName="UserNotificationsDropdown",u.requireAsyncModules=o.once((function(){return new Promise((function(t,n){e(["modules/clean/react/user_notifications/sharing_actions"],t,n)})).then(n.__importStar).then((function(){return null}))})),u.defaultProps={isPagelet:!1,accountMenuVisible:!0},u})(r.default.Component),g=u.requireCssWithComponent(h,["/static/css/scooter/scooter-scoped-vfljL5ijS.css","/static/css/spectrum/index.web-vfl_-DzRS.css","/static/css/notifications-vflbz2mAd.css","/static/css/dig-components/index.web-vflAfUkoe.css"]);t.UserNotificationsDropdown=g})),define("modules/clean/react/user_notifications/dropdown_bell",["require","exports","tslib","spectrum/icon_global","react","modules/core/i18n"],(function(e,t,n,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderBell=function(){return r.default.createElement(o.IconGlobal,{name:"notifications",className:"mcl-notifications-icon",selected:this.props.isSelected})},t.prototype.renderBadge=function(){return this.props.actionableCount?r.default.createElement("div",{className:"badge-red-dot"}):null},t.prototype.render=function(){var e="";return this.props.actionableCount>0&&(e=i.intl.formatMessage({defaultMessage:"{count, plural, one{{count} new} other{{count} new}}"},{count:this.props.actionableCount})),r.default.createElement("div",{className:"notification-button-bell-container"},r.default.createElement("span",{className:"ax-visually-hidden"},e),this.renderBell(),this.renderBadge())},t.defaultProps={actionableCount:0},t})((r=n.__importDefault(r)).default.Component);t.UserNotificationsDropdownBell=a})),define("modules/clean/react/user_notifications/dropdown_bluenote_row",["require","exports","tslib","classnames","purify","react","modules/clean/keycode","modules/clean/react/button","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/avatar_icon","modules/clean/react/user_notifications/generic_icon","modules/clean/react/user_notifications/models","modules/clean/react/user_notifications/single_task_preview","modules/clean/react/user_notifications/thumbnail_preview","modules/clean/referrer_cleansing_redirect"],(function(e,t,n,o,r,i,a,s,u,c,l,d,p,f,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o),r=n.__importStar(r),i=n.__importDefault(i),u=n.__importDefault(u);var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSurfaceAction=function(e){var n=t.props.notification,o=n.typeData.surfaceAction;null!=o&&u.default.triggerBluenoteAction(e,n,o,"surface")},t.handleKeyDown=function(e){e.keyCode!==a.KeyCode.ENTER&&e.keyCode!==a.KeyCode.SPACE||t.handleSurfaceAction(e)},t}return n.__extends(t,e),t.prototype.renderNotificationText=function(e){var t=e.typeData.displayMessage;return t?i.default.createElement("div",{className:"feed-text--button-wrapper"},i.default.createElement("button",{tabIndex:-1,className:"u-unbutton u-font-left feed-text__button"},i.default.createElement("div",{className:"feed-text__button-text",dangerouslySetInnerHTML:{__html:r.sanitize(t)}}))):null},t.prototype.renderImage=function(e){var t=e.typeData.icon;return t&&(t.avatarInitials||t.avatarUrl)?i.default.createElement(c.AvatarIcon,{avatarIconRecord:t,thumbStore:this.props.thumbStore,className:"feed-image feed-image--bluenote"}):i.default.createElement(l.GenericIcon,{genericIconRecord:t,className:"feed-image feed-image--bluenote"})},t.prototype.renderTimeStamp=function(e){var t=e.displayTime;return i.default.createElement("span",{className:"feed-time"},t)},t.prototype.renderPreview=function(e){var t=e.typeData.preview;if(!t)return null;var n=null;t.showThumbnail&&e.bluenoteObject&&(n=i.default.createElement(f.ThumbnailPreview,{object:e.bluenoteObject}));var o=null;t.tasks&&t.tasks.tasks&&t.tasks.tasks.length>0&&t.tasks.tasks[0]&&(o=i.default.createElement(p.SingleTaskPreview,{task:t.tasks.tasks[0]}));var r=null;return t.quote&&(r=i.default.createElement("div",{className:"preview-quote"},t.quote)),i.default.createElement("div",null,n,o,r)},t.prototype.renderButton=function(e,t,n){return i.default.createElement(s.button,{className:"notification u-mar-right-xs u-mar-top-xs",importance:n>0?"tertiary":void 0,onClick:function(t){t.target.disabled=!0;var o=(e.typeData.buttonActions||[])[n];u.default.triggerBluenoteAction(t,e,o,"button_"+n),t.stopPropagation(),t.preventDefault()}},t)},t.prototype.renderButtonActions=function(e){var t=this,n=[];return(e.typeData.buttonActions||[]).forEach((function(o,r){n.push(t.renderButton(e,o.buttonLabel,r))})),n.length>0?i.default.createElement("span",{className:"feed-action action-available"},n):null},t.prototype.render=function(){var e=this.props.notification,t=e.typeData;if(!t)return null;var n=t.surfaceAction,r=o.default({"feed-row":!0,clickable:null!=t.surfaceAction,read:this.props.isAcknowledged}),a=i.default.createElement("div",{onClick:this.handleSurfaceAction,onKeyDown:this.handleKeyDown,className:r,role:"button",tabIndex:0},this.renderImage(e),this.renderNotificationText(e),this.renderPreview(e),this.renderTimeStamp(e),this.renderButtonActions(e));if(null!=n&&n.actionType===d.BluenoteActionTypes.OpenUrl){var s=n.params;if(s.urlPath){var u=_.get_redirect_uri(s.urlPath);return i.default.createElement("a",{href:u.toString()},a)}}return a},t.displayName="UserNotificationsDropdownBluenoteRow",t})(i.default.Component);t.UserNotificationsDropdownBluenoteRow=m})),define("modules/clean/react/user_notifications/dropdown_row",["require","exports","tslib","react","react-dom-factories","prop-types","external/lodash","jquery","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/legacy_thumb_loader","modules/clean/react/user_notifications/models","modules/clean/sprite"],(function(e,t,n,o,r,i,a,s,u,c,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o),r=n.__importStar(r),i=n.__importStar(i),a=n.__importStar(a),s=n.__importDefault(s),u=n.__importDefault(u),d=n.__importDefault(d);var p=r.div,f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._buildLegacyElement=function(e,n){var o=s.default(t.refs.dropdownLegacyRow);return o.html(e.rawDropdownRowHtml),t._initImages(o),t._setTimeLabel(o,e),t._addClientStateClasses(o,e,n),t._initActionHandlers(e,o),o},t._initImages=function(e){return e.find("img").each((function(e,n){var o=s.default(n);return o.attr("alt",""),t._loadImage(o)}))},t._setTimeLabel=function(e,t){var n=e.find("#feed-time-label");if(null!=n)return n.text(t.displayTime)},t._loadImage=function(e){var n=e.data("src");if(n)return t.props.legacyThumbLoader.load(n).progress((function(){return e.data("src",null),e.data("loading-src",n)})).then((function(t){e.data("loading-src",null);var n=function(){return e.addClass("thumbnail"),e.parent(".feed-thumbnail").addClass("has-frame")};return 0===t.indexOf("data:image")?n():(e.load(n),e.error(a.once((function(){var t=e.data("fail-src")||d.default.SPACER;return e.attr("src",t)})))),e.attr("src",t)}))},t._addClientStateClasses=function(e,t,n){var o=e.hasClass("feed-row")?e:e.find(".feed-row");if(t.isInvisible&&o.addClass("invisible"),n)return o.addClass("read")},t._initActionHandlers=function(e,t){return t.on("click",(function(){return u.default.triggerGenericLegacyNotificationAction(e),!0})),t.on("click",".share-content-dismiss",(function(){return u.default.dismissLegacySharingNotification(e,this),!1})),t.on("click",".share-content-mount",(function(){return u.default.mountFromLegacySharingNotification(e,this),!1})),t.on("click",".share-content-upgrade-mount",(function(){return u.default.upgradeToMountFromLegacySharingNotification(e),!1}))},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){return this._buildLegacyElement(this.props.notification,this.props.isAcknowledged)},t.prototype.render=function(){return p({ref:"dropdownLegacyRow"})},t.displayName="UserNotificationsDropdownRow",t.propTypes={notification:i.instanceOf(l.UserNotification).isRequired,legacyThumbLoader:i.instanceOf(c.LegacyThumbLoader).isRequired,isAcknowledged:i.bool.isRequired},t})(o.default.Component);t.default=f})),define("modules/clean/react/user_notifications/generic_icon",["require","exports","tslib","react","modules/clean/react/image","modules/clean/static_urls"],(function(e,t,n,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o),t.GenericIcon=function(e){var t=e.genericIconRecord,n=null!=t?t.lowResIconUrl:null,a=null!=t?t.highResIconUrl:null;return null!=n&&null!=a||(n=i.static_url("/static/images/icons32/system_notification_default_icon-vflSQSQdl.png"),a=i.static_url("/static/images/icons64/system_notification_default_icon-vfl0Gu6Pt.png")),o.default.createElement("div",{className:e.className},o.default.createElement(r.Image,{src:n,srcHiRes:a}))},t.GenericIcon.displayName="GenericIcon"})),define("modules/clean/react/user_notifications/legacy_thumb_loader",["require","exports","tslib","external/lodash","jquery","modules/clean/photos/batch_thumb_loader"],(function(e,t,n,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),r=n.__importDefault(r);var a=(function(){function e(){this._cache={};var e=new i.BatchThumbLoader({batch_size:16,max_parallel_requests:24});this._queueThumb=function(t,n,o){return e.queue_thumb(t,n,{onrequest:o})},this._flushQueue=o.debounce((function(){return e.flush()}),0)}return e.prototype.load=function(e){if(!this._cache[e]){var t=new r.default.Deferred;this._queueThumb(e,t.resolve,t.notify),this._flushQueue(),this._cache[e]=t.promise()}return this._cache[e]},e})();t.LegacyThumbLoader=a})),define("modules/clean/react/user_notifications/renderer",["require","exports","tslib","react","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react/user_notifications/dropdown_bluenote_row","modules/clean/react/user_notifications/dropdown_row","modules/clean/react/user_notifications/legacy_thumb_loader","modules/clean/react/user_notifications/models"],(function(e,t,n,o,r,i,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o),a=n.__importDefault(a);var c=(function(){function e(){this.legacyThumbLoader=new s.LegacyThumbLoader,this.genericThumbStore=new r.GenericThumbStore}return e.prototype.renderNotification=function(e,t){return e.rawDropdownRowHtml?o.default.createElement(a.default,{notification:e,legacyThumbLoader:this.legacyThumbLoader,isAcknowledged:t}):e.typeId===u.NotificationTypes.Bluenote?o.default.createElement(i.UserNotificationsDropdownBluenoteRow,{notification:e,thumbStore:this.genericThumbStore,isAcknowledged:t}):null},e})();t.NotificationRenderer=c})),define("modules/clean/react/user_notifications/shared/icon_mark_as_read",["require","exports","tslib","react"],(function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),t.IconMarkAsRead=function(e){return o.createElement("svg",n.__assign({width:"24",height:"24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),o.createElement("path",{d:"M5 12l4.147 4.608a.5.5 0 0 0 .726.02L19 7.5",stroke:"#1D2737",strokeWidth:"1.5"}))}})),define("modules/clean/react/user_notifications/shared/notification_row_wrapper",["require","exports","tslib","classnames","react","modules/clean/react/css","modules/clean/react/user_notifications/shared/icon_mark_as_read","modules/clean/react/title_bubble","modules/core/i18n"],(function(e,t,n,o,r,i,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o);var c=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={hover:!1},n.onMouseOver=n.onMouseOver.bind(n),n.onMouseOut=n.onMouseOut.bind(n),n}return n.__extends(t,e),t.prototype.onMouseOver=function(){this.setState({hover:!0})},t.prototype.onMouseOut=function(){this.setState({hover:!1})},t.prototype.renderInfoSheet=function(){var e=o.default({"notification-row-info-sheet":!0,"notification-row-info-sheet--visible":this.state.hover,"notification-row-info-sheet--unread":this.props.unread}),t=u.intl.formatMessage({defaultMessage:"Mark as read"});return r.default.createElement("div",{className:e},r.default.createElement(s.TitleBubble,{position:s.TitleBubble.POSITIONS.TOP,content:t},r.default.createElement("button",{className:"notification-row-info-sheet--markasread",onClick:this.props.onAcknowledge,"aria-label":t},r.default.createElement(a.IconMarkAsRead,null))))},t.prototype.render=function(){return r.default.createElement("div",{className:"notification-row-wrapper",onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut},this.props.unread&&this.renderInfoSheet(),this.props.row)},t})((r=n.__importDefault(r)).default.Component),l=i.requireCssWithComponent(c,["/static/css/user_notifications_shared-vfl8FeVwW.css"]);t.NotificationRowWrapper=l})),define("modules/clean/react/user_notifications/shared/tray_chrome",["require","exports","tslib","react","react-dom","modules/clean/react/css","modules/clean/react/user_notifications/shared/tray_section"],(function(e,t,n,o,r,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o),r=n.__importStar(r);var s=(function(e){function t(t){var n=e.call(this,t)||this;n.handleOnScroll=function(){n.scrollWithinOffsetToBottom(10)&&(n.logRendersForPage(n.state.visiblePages),n.setState({visiblePages:n.state.visiblePages+1}))},n.handleOnWheel=function(e){var t=e.originalEvent||e,o=t.deltaY?-40*t.deltaY:t.wheelDelta,i=r.findDOMNode(n);o<=0&&n.scrollWithinOffsetToBottom(0)?e.preventDefault():o>=0&&0===i.scrollTop&&e.preventDefault()};var o=n.processNotifications(n.props.notifications);return n.state={visiblePages:1,unreadNotifications:o.unreadNotifications,readNotifications:o.readNotifications},n}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTrayMount(),this.logRendersForPage(0)},t.prototype.processNotifications=function(e){var t=this.state&&this.state.unreadNotifications||[],n={};t.forEach((function(e){return n[e.key]=!0}));var o=[],r=[];return e.forEach((function(e){e.isUnread||n[e.key]?o.push(e):r.push(e)})),{unreadNotifications:o,readNotifications:r}},t.prototype.logRendersForPage=function(e){var t=this.state.unreadNotifications.concat(this.state.readNotifications).slice(10*e,10*(e+1));this.props.notifLogRenderFunc(t,10*e)},t.prototype.shouldComponentUpdate=function(e,t,n){return!(e.isLoading&&!this.props.isLoading)},t.prototype.componentWillReceiveProps=function(e,t){this.setState(this.processNotifications(e.notifications))},t.prototype.scrollWithinOffsetToBottom=function(e){var t=r.findDOMNode(this);return t.scrollHeight-t.scrollTop-t.offsetHeight<=e},t.prototype.render=function(){if(this.props.isLoading)return o.default.createElement("div",{className:"notifications-tray--loading"},this.props.loadingMessage);if(0===this.state.unreadNotifications.length&&0===this.state.readNotifications.length)return o.default.createElement("div",{className:"notifications-tray--empty"},this.props.emptyMessage);var e=this.state.unreadNotifications.slice(0,10*this.state.visiblePages),t=this.state.readNotifications.slice(0,10*this.state.visiblePages-e.length);return o.default.createElement("div",{className:"notifications-tray--loaded",onScroll:this.handleOnScroll,onWheel:this.handleOnWheel},o.default.createElement(a.NotificationsTraySection,{notifications:e,sectionTitle:this.props.unreadSectionTitle,actionButtonText:this.props.markAllAsReadButtonTitle,actionButtonAction:this.props.markAllAsReadAction,notifRenderFunc:this.props.notifRenderFunc,isUnreadSection:!0}),o.default.createElement(a.NotificationsTraySection,{notifications:t,sectionTitle:this.props.readSectionTitle,notifRenderFunc:this.props.notifRenderFunc,isUnreadSection:!1}))},t.displayName="NotificationsTrayChrome",t})(o.default.Component),u=i.requireCssWithComponent(s,["/static/css/user_notifications_shared-vfl8FeVwW.css"]);t.NotificationsTrayChrome=u})),define("modules/clean/react/user_notifications/shared/tray_section",["require","exports","tslib","react","modules/clean/react/css","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/shared/notification_row_wrapper"],(function(e,t,n,o,r,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o),i=n.__importDefault(i);var s=(function(e){function t(t){var n=e.call(this,t)||this;return n.onClickActionButton=n.onClickActionButton.bind(n),n}return n.__extends(t,e),t.prototype.onClickActionButton=function(){this.props.actionButtonAction&&this.props.actionButtonAction()},t.prototype.renderReadSectionHeader=function(){var e=null;return this.props.actionButtonText&&(e=o.default.createElement("button",{className:"notifications-tray-section-header--button",onClick:this.onClickActionButton,tabIndex:0},this.props.actionButtonText)),o.default.createElement("div",{className:"notifications-tray-section-header"},o.default.createElement("span",{className:"notifications-tray-section-header--title"},this.props.sectionTitle),e)},t.prototype.onAckFactory=function(e){return function(t){t.stopPropagation(),i.default.acknowledge(e)}},t.prototype.render=function(){if(0===this.props.notifications.length)return null;for(var e=[],t=0,n=this.props.notifications;t<n.length;t++){var r=n[t],i=this.props.notifRenderFunc(r,!r.isUnread);null!=i&&e.push(o.default.createElement(a.NotificationRowWrapper,{onAcknowledge:this.onAckFactory(r),row:i,timestamp:r.displayTime,unread:r.isUnread}))}return o.default.createElement("div",null,this.renderReadSectionHeader(),e)},t})(o.default.Component),u=r.requireCssWithComponent(s,["/static/css/user_notifications_shared-vfl8FeVwW.css"]);t.NotificationsTraySection=u})),define("modules/clean/react/user_notifications/single_task_preview",["require","exports","tslib","classnames","spectrum/checkbox","react"],(function(e,t,n,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o);var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.task,t=e.isComplete?"checked":"unchecked",n=o.default({"preview-single-task--text":!0,"preview-single-task--text--complete":e.isComplete});return i.default.createElement("div",{className:"preview-single-task"},i.default.createElement("div",null,i.default.createElement(r.Checkbox,{className:"preview-single-task--checkbox",checked:t,disabled:!0})),i.default.createElement("div",{className:n},e.name))},t})((i=n.__importDefault(i)).default.Component);t.SingleTaskPreview=a})),define("modules/clean/react/user_notifications/thumbnail_preview",["require","exports","tslib","react","spectrum/file_icon","spectrum/icon_content"],(function(e,t,n,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o);var a={"paper-pad":"paper-small","paper-folder":"folder-small","dropbox-folder":"folder-small"},s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.object||{},t=e.type,n=e.name;return t&&n?o.default.createElement("div",{className:"preview-thumbnail--wrapper"},o.default.createElement("div",{className:"preview-thumbnail"},"dropbox-file"===t?o.default.createElement(r.FileIcon,{path:n,variant:"small",className:"preview-thumbnail--icon"}):o.default.createElement(i.IconContent,{name:a[t]||"unknown-small",className:"preview-thumbnail--icon"}),o.default.createElement("div",{className:"preview-thumbnail--text"},n))):null},t.displayName="ThumbnailPreview",t})(o.default.Component);t.ThumbnailPreview=s})),define("modules/clean/sprite",["require","exports","tslib","jquery","modules/clean/static_urls","modules/core/html"],(function(e,t,n,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o);var a={SPACER:r.static_url("/static/images/icons/icon_spacer-vflN3BYt2.gif"),CLASS_PREFIX:"s_",_make_class:function(e,t){return this.CLASS_PREFIX+e+"_"+t},src:function(e,t,n){return this.clear(e),o.default(e).addClass(this._make_class(t,n))},replace:function(e,t,n,r){return o.default(e).removeClass(this._make_class(t,n)).addClass(this._make_class(t,r))},clear:function(e){var t=this,n=e.className.split(" ");return n=o.default.grep(n,(function(e){return e&&0!==e.indexOf(t.CLASS_PREFIX)})),e.className=n.join(" ")},make:function(e,t,n){return n=this._prep_attrs(e,t,n),o.default("<img />",n)[0]},html:function(e,t,n){n=this._prep_attrs(e,t,n);var o=["<img "];for(var r in n)o.push(r,'="',i.HTML._raw_escape(n[r]),'" ');return o.push("/>"),new i.HTML(o.join(""))},_prep_attrs:function(e,t,n){void 0===n&&(n={}),n.src=n.src||this.SPACER;var o=["sprite","sprite_"+e,this._make_class(e,t)];return n.class&&o.push(n.class),n.class=o.join(" "),n},_get:function(e){return e.className},_set:function(e,t){return e.className=t,e.src=this.SPACER}};t.default=a}));
//# sourceMappingURL=pkg-notifications.min.js-vflqJo7Jn.map